<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Unity3d插件编写 | Hexo</title><script src="//unpkg.com/valine/dist/Valine.min.js"></script><script>var config = {"root":"/","path":""}</script><script src="//unpkg.com/mermaid@8.13.5/dist/mermaid.min.js"></script><script>mermaid.initialize({
 startOnLoad: true
 , theme: 'dark'
});</script><link rel="stylesheet" href="/css/arknights.css"><link rel="stylesheet" href="//unpkg.com/@highlightjs/cdn-assets@11.4.0/styles/atom-one-dark-reasonable.min.css"><style>@font-face {
 font-family: BenderLight;
 src: local('Bender'), url("/font/BenderLight.ttf");
}
@font-face {
 font-family: 'JetBrains Mono';
 src: local('JetBrains Mono'), url('/font/JetBrainsMono-Regular.woff2') format('woff2');
}</style><meta name="generator" content="Hexo 6.3.0"></head><body style="background-image:url(https://ak.hypergryph.com/assets/index/images/ak/pc/bk.jpg);"><main><header class="closed"><nav><div class="navBtn"><i class="navBtnIcon"><span class="navBtnIconBar"></span><span class="navBtnIconBar"></span><span class="navBtnIconBar"></span></i></div><ol class="navContent"><li class="navItem" id="search-header"><span class="navItemTitle"><input autocomplete="off" autocorrect="off" autocapitalize="none" placeholder="数据检索" spellcheck="false" maxlength="50" type="text" id="search-input"></span></li><li class="navItem"><a class="navBlock" href="/"><span class="navItemTitle">Home</span></a></li><li class="navItem" matchdata="categories,tags"><a class="navBlock" href="/archives/"><span class="navItemTitle">Archives</span></a></li><li class="navItem"><a class="navBlock" href="/demo/"><span class="navItemTitle">独立页面</span></a></li></ol></nav><div class="search-popup"><div id="search-result"></div></div></header><article><div id="post-bg"><div id="post-title"><h1>Unity3d插件编写</h1><div id="post-info"><span>First Post: <div class="control"><time datetime="2022-06-10T07:29:02.000Z" id="date"> 2022-06-10</time></div></span><br><span>Last Update: <div class="control"><time datetime="2022-09-16T20:07:05.436Z" id="updated"> 2022-09-17</time></div></span><br><span>Word Count: <div class="control">2.9k</div></span><br><span>Read Time: <div class="control">11 min</div></span></div></div><hr><div id="post-content"><h1 id="Unity3d插件编写"><a href="#Unity3d插件编写" class="headerlink" title="Unity3d插件编写"></a>Unity3d插件编写</h1><h3 id="如何让编辑器运行你的代码如何让编辑器运行你的代码"><a href="#如何让编辑器运行你的代码如何让编辑器运行你的代码" class="headerlink" title="如何让编辑器运行你的代码如何让编辑器运行你的代码"></a>如何让编辑器运行你的代码如何让编辑器运行你的代码</h3><p>Unity3D可以通过事件触发来执行你的编辑器代码，但是需要一些编译器参数来告知编译器何时需要触发该段代码。 [MenuItem(XXX)]声明在一个函数上方，告知编译器给Unity3D编辑器添加一个菜单项，并且当点击该菜单项的时候调用该函数。触发函数里可以编写任何合法的代码，可以是一个资源批处理程序，也可以弹出一个编辑器窗口。代码里可以访问到当前选中的内容（通过Selection类），并据此来确定显示视图。与此类似，[ContextMenu(“XXX”)]可以向你的上下文菜单中添加一个菜单项。 当你编写了一些Component脚本，当它被附属到某个GameObject时，想在编辑视图即可在Scene视图观察到效果，那么你可以把[ExecuteInEditMode]写在类上方来通知编译器，该类的OnGUI和Update等函数在编辑模式也也会被调用。我们还可以使用[AddComponentMenu(“XXX&#x2F;XXX”)]来把该脚本关联到Component菜单中，点击相应菜单项即可为GameObject添加该Component脚本。 </p>
<h3 id="开始编写编辑器"><a href="#开始编写编辑器" class="headerlink" title="开始编写编辑器"></a>开始编写编辑器</h3><p>为了避免不必要的包含，Unity3D的运行时和编辑器类分辨存储在不同的Assemblies里（UnityEngine和UnityEditor）。当你准备开始编写编辑器之前，你需要using UnityEditor来导入编辑器的名称空间。 有些代码可能是运行时和编辑器都需要执行的，如果你想在其中加以区分，那么可以使用#if UNITY_EDITOR … #endif宏来对编辑器代码做特殊处理。 在你开始真正编写代码之前，我认为你还需要知道所有放在命名为Editor目录下的脚本会在其它脚本之后进行编译，这方便了你去使用那些运行时的内容。而那些目录下的脚本是不能访问到Editor目录下的内容的。所以，你最好把你的编辑器脚本写在Editor目录下。</p>
<h3 id="如何创建自定义编辑器窗口"><a href="#如何创建自定义编辑器窗口" class="headerlink" title="如何创建自定义编辑器窗口"></a>如何创建自定义编辑器窗口</h3><p>创建窗口，如果想自定义一个可编辑的面板，那么你需要编写一个继承自Editor的类。通常情况下，你还需要写一个[MenuItem]来告知编译器何时打开这个面板。这个事件的回调应该是一个静态方法，并且返回一个窗口的实例。现在，当点击对应的菜单项时，会弹出一个空白的窗口。并且可以像Unity3D编辑器预制的窗口一样随意拖动和停靠。下面来看看如何来在窗口内实现想要的功能吧。</p>
<h3 id="扩展你的窗口"><a href="#扩展你的窗口" class="headerlink" title="扩展你的窗口"></a>扩展你的窗口</h3><p>和运行时的GUI一样，如果你需要在窗口中添加交互控件，那么必须重写OnGUI方法。具体的重写方式和运行时的GUI一样，你甚至可以使用任何扩展自原生GUI系统的插件（例如iGUI和GUIX）来简化你的插件开发流程（仅经过初步测试，更深层次的可用性尚待验证）。同时UnityEditor名称空间下的EditorGUILayout在原生GUI之上提供了一些更方便的接口和控件，让你可以轻松的使用一些编辑器特有的UI控件。 除了OnGUI外，你可能还会需要如下一些回调来触发某些具体的逻辑（完整的列表请参考官方文档）：  OnSelectionChange，但你点选物品时触发  OnFocus &#x2F;OnLostFocus，获得和失去焦点时触发 </p>
<h3 id="进一步扩展你的窗口"><a href="#进一步扩展你的窗口" class="headerlink" title="进一步扩展你的窗口"></a>进一步扩展你的窗口</h3><p>自定义控件  和运行时GUI的使用方式一样，如果你打算自定义自己的控件，那么最简单的方式就是实现一个静态方法（也可以不是静态的），并提供一些可选参数，在方法内部根据这些参数来完成对控件的布局（就像你在OnGUI中做的一样）。  如果你打算把自定义控件实现在窗口类内部，你可以使用Partial类来更好的管理你的代码。 绘制2D内容 绘制图片  可以使用GUI.DrawTexture来完成对图片资源的绘制。 绘制基础图元 GUI本身并没有提供绘制基础图元的方法，但是可以通过一些方式来封装出这些方法。  绘制线段：通过一个像素的贴图资源配合GUI.DrawTexture和矩阵旋转来完成线段的绘制。  绘制矩形框：通过GUI.Box和样式设置来封装出对矩形框和矩形填充框。 资源选择器 EditorLayout.ObjectField控件提供一个资源选择逻辑，生成时需要指定某种资源类型。然后你可以拖动该种资源到该控件或点击控件旁边的小圆圈进行列表进行选择。 </p>
<h3 id="如何存储编辑内容"><a href="#如何存储编辑内容" class="headerlink" title="如何存储编辑内容"></a>如何存储编辑内容</h3><p>你可能需要创建一个继承自SerializedObject的类来保存编辑的数据。继承自SerializedObject的对象能用于存储数据而不参与渲染，并可以最终打包到AssetBundle。 针对当前的编辑选项等内容的存储，可能需要另外一个SerializedObject类（和具体的系统设计相关）。 </p>
<h3 id="向导式的编辑窗口"><a href="#向导式的编辑窗口" class="headerlink" title="向导式的编辑窗口"></a>向导式的编辑窗口</h3><p> 在很多情况下可能你都会需要一个有很多参数的编辑面板，然后在编辑结束后有一个按钮加以确认。这你不用自己来实现，UnityEditor提供了ScriptableWizard来帮助你快捷的进行开发。 他是继承自EditorWindow的，所以他们的使用是很类似的。不过注意，当你点击确认按钮时，OnWizardCreate()会被调用。另外，ScriptableWizard.DisplayWizard可以帮助你生成并显示出该窗口。 </p>
<h3 id="如何扩展INSPECTOR面板"><a href="#如何扩展INSPECTOR面板" class="headerlink" title="如何扩展INSPECTOR面板"></a>如何扩展INSPECTOR面板</h3><p> 当你在Unity3D中点选一个对象时，Inspector面板会随即显示出此对象的属性。我们可以针对某个类型的对象扩展该面板，这在为Unity3D开发插件时是非常有用的。 </p>
<h3 id="定义INSPECTOR何时被触发"><a href="#定义INSPECTOR何时被触发" class="headerlink" title="定义INSPECTOR何时被触发"></a>定义INSPECTOR何时被触发</h3><p> 自定义的Inspector面板需要继承Editor类。由于功能相对具体，所以你无需定义代码何时被触发，对应代码会在你点击它所对应的物体时自动执行。 那么如何定义它所对应的类型呢？只需要在你的类定义之前通过编译器的命令[CustomEditor(typeof(XXX))]就可以完成这项工作了。 </p>
<h3 id="访问被编辑的对象"><a href="#访问被编辑的对象" class="headerlink" title="访问被编辑的对象"></a>访问被编辑的对象</h3><p>在Inspector视图中，我们经常需要访问正在被编辑的对象。Editor类的成员变量target正是提供了这一关联。  尽管如此，需要注意target是一个Object类型的对象，具体使用时可能需要类型转换（可以使用C#的泛型来避免重复的类型转换）。 </p>
<h3 id="实现你自己的INSPECTOR界面"><a href="#实现你自己的INSPECTOR界面" class="headerlink" title="实现你自己的INSPECTOR界面"></a>实现你自己的INSPECTOR界面</h3><p>扩展Editor与扩展EditorWindow唯一的不同在于你需要重写的是OnInspectorGUI而不是OnGUI。另外，如果你想绘制默认的可编辑项，只需调用DrawDefaultInspector即可。 </p>
<h3 id="在SCENE界面定义编辑句柄"><a href="#在SCENE界面定义编辑句柄" class="headerlink" title="在SCENE界面定义编辑句柄"></a>在SCENE界面定义编辑句柄</h3><p>当选中一个物体的时候，可能我们希望在Scene视图里也能定义一些编辑或展现。这一工作可以通过OnSceneGUI和Handle类来完成。OnSceneGUI用来处理来自Scene视图的事件，而Handle类用来在Scene视图实现一些3D的GUI控件（例如控制对象位置的Position控制器）。 具体的使用方式可以参考官方的参考文档。 </p>
<h3 id="一些常用的功能说明"><a href="#一些常用的功能说明" class="headerlink" title="一些常用的功能说明"></a>一些常用的功能说明</h3><p> AssetDatabase.CreateAsset可以帮住你从资源目录中创建一个资源实例。  Selection.activeObject返回当前选中的对象。  EditorGUIUtility.PingObject用来实现在Project窗口中点击某一项的操作。  Editor.Repaint用来重绘界面所有的控件。  XXXImporter用来设置某种资源的具体导入设置（例如在某些情况下你需要设置导入的贴图为可读的）。 EditorUtility.UnloadUnusedAssets用于释放没有使用的资源，避免你的插件产生内存泄漏。  Event.Use用来标记事件已经被处理结束了。  EditorUtility.SetDirty用来通知编辑器数据已被修改，这样在下次保存时新的数据将被存储。 </p>
<h3 id="例子"><a href="#例子" class="headerlink" title="例子"></a>例子</h3><p>保存为CopyComponent.cs，放置在Plugin&#x2F;Editor目录下</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs c#"><span class="hljs-keyword">using</span> System.Collections;<br><span class="hljs-keyword">using</span> System.Collections.Generic;<br><span class="hljs-keyword">using</span> UnityEngine;<br><span class="hljs-keyword">using</span> UnityEditor;<br><span class="hljs-keyword">using</span> System;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">CopyComponent</span> : <span class="hljs-title">Editor</span><br>&#123;<br><span class="hljs-meta">#<span class="hljs-keyword">if</span> UNITY_EDITOR</span><br>    <span class="hljs-keyword">static</span> Component[] compoentArr;<br><br>    [<span class="hljs-meta">MenuItem(<span class="hljs-string">&quot;Tools/Test&quot;</span>)</span>]<br>    <span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">DoCopyComponent</span>()</span><br>    &#123;<br>        Debug.Log(<span class="hljs-string">&quot;Test&quot;</span>)<br>    &#125;<br><span class="hljs-meta">#<span class="hljs-keyword">endif</span></span><br>&#125;<br></code></pre></td></tr></table></figure>





<h2 id="自定义快捷键"><a href="#自定义快捷键" class="headerlink" title="自定义快捷键"></a>自定义快捷键</h2><p>一、前言<br>在使用Unity中可能需要使用快捷键执行一些操作，或者修改Unity自带的快捷键，接下来就看一下，如何设置自定义快捷键吧。</p>
<p>组合快捷键Ctrl+Shift+Q</p>
<p>[MenuItem(“Custom快捷键&#x2F;Ctrl+Shift+Q %#Q”)]</p>
<p>Custom快捷键： 自定义，随便写<br>Ctrl+Shift+Q： 自定义，随便写<br>%#Q： 快捷键设置，Ctrl&#x3D;% Shift&#x3D;# Q&#x3D;Q。。前面记得加空格.</p>
<p>四、功能实例<br>暂停编辑器：<br>EditorApplication.isPaused &#x3D; !EditorApplication.isPaused;</p>
<p>播放：<br>EditorApplication.isPlaying &#x3D; true;</p>
<p>单步执行：<br>EditorApplication.Step();</p>
<p>打开场景，并运行<br>EditorSceneManager.OpenScene(“Assets&#x2F;Scenes&#x2F;LandInit.unity”);<br>EditorApplication.isPlaying &#x3D; true;</p>
<p>效果：</p>
<p>二、快捷键大全<br>快捷键	指令</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">%	CTRL<br>#   Shift<br>&amp;	Alt<br>LEFT/RIGHT/UP/DOWN	箭头上下左右<br>F1-F12	键盘快捷键F1-F12<br>HOME/END/PGUP/PDDN	对应键盘的Home/End/PageUp/PageDown<br></code></pre></td></tr></table></figure>





<p>三、实例<br>代码：</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs c#"><span class="hljs-keyword">using</span> UnityEditor;<br><span class="hljs-keyword">using</span> UnityEngine;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">CustomKeys</span> : <span class="hljs-title">Editor</span><br>&#123;<br>    [<span class="hljs-meta">MenuItem(<span class="hljs-string">&quot;Custom快捷键/F1按键 _F1&quot;</span>)</span>]<br>    <span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">EditorCustorkKeys1</span>()</span><br>    &#123;<br>        Debug.Log(<span class="hljs-string">&quot;F1点击执行的指令&quot;</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>这个就是自定义了一个F1的快捷键指令</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs c#"><span class="hljs-keyword">using</span> UnityEditor;<br><span class="hljs-keyword">using</span> UnityEngine;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">CustomKeys</span> : <span class="hljs-title">Editor</span><br>&#123;<br>    [<span class="hljs-meta">MenuItem(<span class="hljs-string">&quot;Custom快捷键/Ctrl+Q %Q&quot;</span>)</span>]<br>    <span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">EditorCustorkKeys2</span>()</span><br>    &#123;<br>        Debug.Log(<span class="hljs-string">&quot;Ctrl+Q点击执行的指令&quot;</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>





<p>组合快捷键Ctrl+Q</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs c#"><span class="hljs-keyword">using</span> UnityEditor;<br><span class="hljs-keyword">using</span> UnityEngine;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">CustomKeys</span> : <span class="hljs-title">Editor</span><br>&#123;<br>    [<span class="hljs-meta">MenuItem(<span class="hljs-string">&quot;Custom快捷键/Ctrl+Shift+Q %#Q&quot;</span>)</span>]<br>    <span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">EditorCustorkKeys3</span>()</span><br>    &#123;<br>        Debug.Log(<span class="hljs-string">&quot;Ctrl+Shift+Q点击执行的指令&quot;</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>









<h2 id="例子-1"><a href="#例子-1" class="headerlink" title="例子"></a>例子</h2><p>写一个复制组件的插件，更方便的进行组件复制和粘贴。</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br></pre></td><td class="code"><pre><code class="hljs c#"><span class="hljs-keyword">using</span> System.Collections;<br><span class="hljs-keyword">using</span> System.Collections.Generic;<br><span class="hljs-keyword">using</span> UnityEngine;<br><span class="hljs-keyword">using</span> UnityEditor;<br><span class="hljs-keyword">using</span> System;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">CopyComponent</span> : <span class="hljs-title">Editor</span><br>&#123;<br><br><span class="hljs-meta">#<span class="hljs-keyword">if</span> UNITY_EDITOR</span><br>    <span class="hljs-keyword">static</span> Component[] compoentArr;<br><br>    [<span class="hljs-meta">MenuItem(<span class="hljs-string">&quot;Tools/Component/Copy All %&amp;A&quot;</span>)</span>]<br>    <span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">DoCopyComponent</span>()</span><br>    &#123;<br>        Component[] allCompoents = Selection.activeGameObject.GetComponents&lt;Component&gt;();<br>        <span class="hljs-keyword">if</span> (allCompoents == <span class="hljs-literal">null</span>) <span class="hljs-keyword">return</span>;<br>    &#125;<br><br>    [<span class="hljs-meta">MenuItem(<span class="hljs-string">&quot;Tools/Component/Copy All Execpt Transform %&amp;E&quot;</span>)</span>]<br>    <span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">DoCopyComponent_Except_1</span>()</span><br>    &#123;<br>        Component[] allCompoents = Selection.activeGameObject.GetComponents&lt;Component&gt;();<br>        <span class="hljs-keyword">if</span> (allCompoents == <span class="hljs-literal">null</span>) <span class="hljs-keyword">return</span>;<br><br>        <span class="hljs-built_in">int</span> length = <span class="hljs-number">0</span>;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-built_in">int</span> i = <span class="hljs-number">0</span>; i &lt; allCompoents.Length; i++)<br>        &#123;<br>            <span class="hljs-keyword">if</span> (allCompoents[i].GetType().Name == <span class="hljs-string">&quot;RectTransform&quot;</span> || allCompoents[i].GetType().Name == <span class="hljs-string">&quot;Transform&quot;</span>) <span class="hljs-keyword">continue</span>;<br>            length++;<br>        &#125;<br><br>        <span class="hljs-keyword">if</span> (length == <span class="hljs-number">0</span>) <span class="hljs-keyword">return</span>;<br><br>        compoentArr = <span class="hljs-keyword">new</span> Component[length];<br>        <span class="hljs-keyword">for</span> (<span class="hljs-built_in">int</span> i = <span class="hljs-number">0</span>,j = <span class="hljs-number">0</span>; i &lt; allCompoents.Length; i++)<br>        &#123;<br>            <span class="hljs-keyword">if</span> (allCompoents[i].GetType().Name == <span class="hljs-string">&quot;RectTransform&quot;</span> || allCompoents[i].GetType().Name == <span class="hljs-string">&quot;Transform&quot;</span>) <span class="hljs-keyword">continue</span>;<br>            compoentArr[j] = allCompoents[i];<br>            j++;<br>        &#125;<br><br>    &#125;<br><br>    [<span class="hljs-meta">MenuItem(<span class="hljs-string">&quot;Tools/Component/Paste %&amp;V&quot;</span>)</span>]<br>    <span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">DoPasteComponent</span>()</span><br>    &#123;<br>        <span class="hljs-keyword">if</span> (compoentArr == <span class="hljs-literal">null</span>)<br>        &#123;<br>            <span class="hljs-keyword">return</span>;<br>        &#125;<br><br>        GameObject targetObject = Selection.activeGameObject;<br>        <span class="hljs-keyword">if</span> (targetObject == <span class="hljs-literal">null</span>)<br>        &#123;<br>            <span class="hljs-keyword">return</span>;<br>        &#125;<br><br>        <span class="hljs-keyword">for</span> (<span class="hljs-built_in">int</span> i = <span class="hljs-number">0</span>; i &lt; compoentArr.Length; i++)<br>        &#123;<br>            Component newComponent = compoentArr[i];<br>            <span class="hljs-keyword">if</span> (newComponent == <span class="hljs-literal">null</span>)<br>            &#123;<br>                <span class="hljs-keyword">continue</span>;<br>            &#125;<br>            UnityEditorInternal.ComponentUtility.CopyComponent(newComponent);<br>            Component oldComponent = targetObject.GetComponent(newComponent.GetType());<br>            <span class="hljs-keyword">if</span> (oldComponent != <span class="hljs-literal">null</span>) <span class="hljs-comment">// 存在旧的组件</span><br>            &#123;<br>                <span class="hljs-keyword">if</span> (UnityEditorInternal.ComponentUtility.PasteComponentValues(oldComponent))<br>                &#123;<br>                    Debug.Log(<span class="hljs-string">&quot;Paste Component&quot;</span> + newComponent.GetType().ToString() + <span class="hljs-string">&quot; Success&quot;</span>);<br>                &#125;<br>                <span class="hljs-keyword">else</span><br>                &#123;<br>                    Debug.Log(<span class="hljs-string">&quot;Paste Component &quot;</span> + newComponent.GetType().ToString() + <span class="hljs-string">&quot; Failed&quot;</span>);<br>                &#125;<br>            &#125;<br>            <span class="hljs-keyword">else</span> <span class="hljs-comment">// 存在旧的组件</span><br>            &#123;<br>                <span class="hljs-keyword">if</span> (UnityEditorInternal.ComponentUtility.PasteComponentAsNew(targetObject))<br>                &#123;<br>                    Debug.Log(<span class="hljs-string">&quot;Paste Component Overwrited&quot;</span> + newComponent.GetType().ToString() + <span class="hljs-string">&quot; Success&quot;</span>);<br>                &#125;<br>                <span class="hljs-keyword">else</span><br>                &#123;<br>                    Debug.Log(<span class="hljs-string">&quot;Paste Component Overwrited&quot;</span> + newComponent.GetType().ToString() + <span class="hljs-string">&quot; Failed&quot;</span>);<br>                &#125;<br>            &#125;<br>        &#125;<br>    &#125;<br><span class="hljs-meta">#<span class="hljs-keyword">endif</span></span><br>&#125;<br></code></pre></td></tr></table></figure>





<p>ref: <a target="_blank" rel="noopener" href="https://blog.csdn.net/q764424567/article/details/108639136">https://blog.csdn.net/q764424567/article/details/108639136</a></p>
<div id="paginator"></div></div><div id="post-footer"><div id="pages"><div id="footer-link" style="right: calc(50% - 1px);order: 1;border-right: 1px solid #fe2;padding-left: unset;max-width: calc(50% - 4px);"><a href="/2022/06/18/dev/game/u3d/%E6%89%93%E5%8C%85API/">← Next Unity3d打包API</a></div><div id="footer-link" style="left: 50%;order: 0;border-left: 1px solid #fe2;padding-right: unset;max-width: calc(50% - 5px);"><a href="/2022/06/05/dev/tools/vs/">Visual Studio快捷键 Prev →</a></div></div></div><details id="reward"><summary>打赏</summary><div id="alipay"><span>支付宝 | Alipay</span><br><img src="/img/Alipay.png"></div><div id="wechat"><span>微信 | WeChat</span><br><img src="/img/WeChat.png"></div></details><div id="Valine"></div></div><div id="bottom-btn"><a id="to-index" href="#toc-div" title="index">≡</a><a id="to-top" onClick="scrolls.scrolltop();" title="to top" style="opacity: 0; display: none;">∧</a></div></article><aside><div id="aside-top"><div id="about"><a href="/" id="logo"><img src="https://ak.hypergryph.com/assets/index/images/ak/pc/faction/1.png" alt="Logo"></a><h1 id="Dr"><a target="_blank" rel="noopener" href="https://github.com/Yue-plus">John Doe</a></h1><div id="description"></div></div><div id="aside-block"><div id="toc-div"><h1>INDEX</h1><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Unity3d%E6%8F%92%E4%BB%B6%E7%BC%96%E5%86%99"><span class="toc-number">1.</span> <span class="toc-text">Unity3d插件编写</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A6%82%E4%BD%95%E8%AE%A9%E7%BC%96%E8%BE%91%E5%99%A8%E8%BF%90%E8%A1%8C%E4%BD%A0%E7%9A%84%E4%BB%A3%E7%A0%81%E5%A6%82%E4%BD%95%E8%AE%A9%E7%BC%96%E8%BE%91%E5%99%A8%E8%BF%90%E8%A1%8C%E4%BD%A0%E7%9A%84%E4%BB%A3%E7%A0%81"><span class="toc-number">1.0.1.</span> <span class="toc-text">如何让编辑器运行你的代码如何让编辑器运行你的代码</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BC%80%E5%A7%8B%E7%BC%96%E5%86%99%E7%BC%96%E8%BE%91%E5%99%A8"><span class="toc-number">1.0.2.</span> <span class="toc-text">开始编写编辑器</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A6%82%E4%BD%95%E5%88%9B%E5%BB%BA%E8%87%AA%E5%AE%9A%E4%B9%89%E7%BC%96%E8%BE%91%E5%99%A8%E7%AA%97%E5%8F%A3"><span class="toc-number">1.0.3.</span> <span class="toc-text">如何创建自定义编辑器窗口</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%89%A9%E5%B1%95%E4%BD%A0%E7%9A%84%E7%AA%97%E5%8F%A3"><span class="toc-number">1.0.4.</span> <span class="toc-text">扩展你的窗口</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%BF%9B%E4%B8%80%E6%AD%A5%E6%89%A9%E5%B1%95%E4%BD%A0%E7%9A%84%E7%AA%97%E5%8F%A3"><span class="toc-number">1.0.5.</span> <span class="toc-text">进一步扩展你的窗口</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A6%82%E4%BD%95%E5%AD%98%E5%82%A8%E7%BC%96%E8%BE%91%E5%86%85%E5%AE%B9"><span class="toc-number">1.0.6.</span> <span class="toc-text">如何存储编辑内容</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%90%91%E5%AF%BC%E5%BC%8F%E7%9A%84%E7%BC%96%E8%BE%91%E7%AA%97%E5%8F%A3"><span class="toc-number">1.0.7.</span> <span class="toc-text">向导式的编辑窗口</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A6%82%E4%BD%95%E6%89%A9%E5%B1%95INSPECTOR%E9%9D%A2%E6%9D%BF"><span class="toc-number">1.0.8.</span> <span class="toc-text">如何扩展INSPECTOR面板</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%9A%E4%B9%89INSPECTOR%E4%BD%95%E6%97%B6%E8%A2%AB%E8%A7%A6%E5%8F%91"><span class="toc-number">1.0.9.</span> <span class="toc-text">定义INSPECTOR何时被触发</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AE%BF%E9%97%AE%E8%A2%AB%E7%BC%96%E8%BE%91%E7%9A%84%E5%AF%B9%E8%B1%A1"><span class="toc-number">1.0.10.</span> <span class="toc-text">访问被编辑的对象</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%9E%E7%8E%B0%E4%BD%A0%E8%87%AA%E5%B7%B1%E7%9A%84INSPECTOR%E7%95%8C%E9%9D%A2"><span class="toc-number">1.0.11.</span> <span class="toc-text">实现你自己的INSPECTOR界面</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9C%A8SCENE%E7%95%8C%E9%9D%A2%E5%AE%9A%E4%B9%89%E7%BC%96%E8%BE%91%E5%8F%A5%E6%9F%84"><span class="toc-number">1.0.12.</span> <span class="toc-text">在SCENE界面定义编辑句柄</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%80%E4%BA%9B%E5%B8%B8%E7%94%A8%E7%9A%84%E5%8A%9F%E8%83%BD%E8%AF%B4%E6%98%8E"><span class="toc-number">1.0.13.</span> <span class="toc-text">一些常用的功能说明</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BE%8B%E5%AD%90"><span class="toc-number">1.0.14.</span> <span class="toc-text">例子</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%87%AA%E5%AE%9A%E4%B9%89%E5%BF%AB%E6%8D%B7%E9%94%AE"><span class="toc-number">1.1.</span> <span class="toc-text">自定义快捷键</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BE%8B%E5%AD%90-1"><span class="toc-number">1.2.</span> <span class="toc-text">例子</span></a></li></ol></li></ol></div></div></div><footer><nobr><span class="text-title">ICP</span><a class="text-content" target="_blank" rel="noopener" href="https://beian.miit.gov.cn/">赣ICP备19008355号</a></nobr><nobr><span class="text-title">©</span><span class="text-content">1970 to 2020</span></nobr><br><nobr>published with <a target="_blank" rel="noopener" href="http://hexo.io">Hexo</a></nobr><wbr><nobr> Theme <a target="_blank" rel="noopener" href="https://github.com/Yue-plus/hexo-theme-arknights">Arknight</a></nobr><wbr><nobr>by <a target="_blank" rel="noopener" href="https://github.com/Yue-plus">Yue_plus</a></nobr></footer></aside></main><canvas id="canvas-dust"></canvas><div id="cursor-container"><div id="cursor-outer"></div><div id="cursor-effect"></div></div><script src="/js/search.js"></script><script class="pjax-js">reset=_=>{new Valine({
 el: '#Valine'
 , appId: 'LSe7mf1XYliLqgIrc3jlqXfT-gzGzoHsz'
 , appKey: 'Fu9giJfnidkCamaW89FUpidw' , placeholder: '此条评论委托企鹅物流发送'
});code.findCode();mermaid.init(undefined, ('.mermaid'));}</script><script src="//unpkg.com/@highlightjs/cdn-assets@11.4.0/highlight.min.js"></script><script src="/js/arknights.js"></script><script>window.addEventListener("load",()=>{reset()})</script></body></html>