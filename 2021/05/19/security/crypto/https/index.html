<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>https c语言实现双向认证 | I0gan's blog</title><script src="//unpkg.com/valine/dist/Valine.min.js"></script><script>var config = {"root":"/","path":"search.json"}</script><script src="//unpkg.com/mermaid@8.13.5/dist/mermaid.min.js"></script><script>mermaid.initialize({
 startOnLoad: true
 , theme: 'dark'
});</script><link rel="stylesheet" href="/css/arknights.css"><link rel="stylesheet" href="//unpkg.com/@highlightjs/cdn-assets@11.4.0/styles/atom-one-dark-reasonable.min.css"><style>@font-face {
 font-family: BenderLight;
 src: local('Bender'), url("/font/BenderLight.ttf");
}
@font-face {
 font-family: 'JetBrains Mono';
 src: local('JetBrains Mono'), url('/font/JetBrainsMono-Regular.woff2') format('woff2');
}</style><meta name="generator" content="Hexo 6.3.0"></head><body style="background-image:url(/img/bg.jpg);"><main><header class="closed"><nav><div class="navBtn"><i class="navBtnIcon"><span class="navBtnIconBar"></span><span class="navBtnIconBar"></span><span class="navBtnIconBar"></span></i></div><ol class="navContent"><li class="navItem" id="search-header"><span class="navItemTitle"><input autocomplete="off" autocorrect="off" autocapitalize="none" placeholder="Search" spellcheck="false" maxlength="50" type="text" id="search-input"></span></li><li class="navItem"><a class="navBlock" href="/"><span class="navItemTitle">Home</span></a></li><li class="navItem"><a class="navBlock" href="/about/"><span class="navItemTitle">About</span></a></li><li class="navItem" matchdata="categories,tags"><a class="navBlock" href="/archives/"><span class="navItemTitle">Archives</span></a></li><li class="navItem"><a class="navBlock" href="/shell/"><span class="navItemTitle">Shell</span></a></li></ol></nav><div class="search-popup"><div id="search-result"></div></div></header><article><div id="post-bg"><div id="post-title"><h1>https c语言实现双向认证</h1><div id="post-info"><span>First Post: <div class="control"><time datetime="2021-05-19T08:44:24.000Z" id="date"> 2021-05-19</time></div></span><br><span>Last Update: <div class="control"><time datetime="2022-10-24T08:53:36.477Z" id="updated"> 2022-10-24</time></div></span><br><span>Word Count: <div class="control">2.3k</div></span><br><span>Read Time: <div class="control">12 min</div></span></div></div><hr><div id="post-content"><h1 id="https-c语言实现双向认证"><a href="#https-c语言实现双向认证" class="headerlink" title="https c语言实现双向认证"></a>https c语言实现双向认证</h1><p><strong>安装openssl安装包</strong></p>
<p>在以下网站下载openssl:</p>
<p><a target="_blank" rel="noopener" href="http://www.openssl.org/source/openssl-1.0.0a.tar.gz">http://www.openssl.org/source/openssl-1.0.0a.tar.gz</a></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">tar -zxvf openssl-1.0.0a.tar.gz<br>mv openssl-1.0.1a openssl<br>cd openssl<br></code></pre></td></tr></table></figure>

<p> 如果需要zlib压缩模块的话，还需要先安装zlib</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">./config --prefix=/usr/local/ssl shared zlib-dynamic enable-camellia<br></code></pre></td></tr></table></figure>

<p> 不需要就直接用：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">./config --prefix=/usr/local/ssl shared no-zlib<br></code></pre></td></tr></table></figure>

<p> 更多详细帮助请运行</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">./config –help<br>./config –t<br>make depend<br>make<br>make test<br>sudo make install<br></code></pre></td></tr></table></figure>

<p> 设置环境变量：在&#x2F;etc&#x2F;profile的PATH中增加如下内容</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">PATH=/usr/local/ssl/bin:/sbin/:$PATH:/usr/sbin<br>export PATH<br>cat /etc/ssl/openssl.cnf<br>//查看路径<br>which openssl<br>//查看版本<br>openssl version<br>openssl安装完毕<br></code></pre></td></tr></table></figure>

<p><strong>如果计算机联网的话可以使用如下命令安装比较简便</strong></p>
<p>Ubuntu系统下安装openssl</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">sudo apt-get install openssl<br>//安装openssl-devel<br>//由于ubuntu下无法安装openssl-devel 所以使用libssl-dev代替openssl-devel<br>sudo apt-get install libssl-dev<br></code></pre></td></tr></table></figure>

<p>CentOS系统下安装openssl</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">//解压openssl安装包<br>[root@localhost opt]# tar xvzf openssl-1.0.0d.tar.gz<br>//进入解压后的目录<br>[root@localhost opt]# cd openssl-1.0.0d<br>//修改openssl配置文件<br>[root@localhost openssl-1.0.0d]# ./configure --prefix=/usr/local/openssl<br>//编译代码<br>[root@localhost openssl-1.0.0d]# make<br>//安装<br>[root@localhost openssl-1.0.0d]# make install<br>//安装curses.h头文件的库<br>sudo apt-get install libncurses5-dev<br>//所需软件安装完毕：openssl、openssl-devel、libncurses5-dev 三个软件<br></code></pre></td></tr></table></figure>

<p><strong>生成工作目录产生CA凭证</strong></p>
<p>ca.crt 为自签名证书；<br>server.crt，server.key 为服务器端的证书和私钥文件；<br>proxy.crt，proxy.key 为代理服务器端的证书和私钥文件；<br>client.crt，client.key 为客户端的证书和私钥文件。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">//把openssl安装目录下的misc拷贝到用户目录下<br>cd<br>mkdir sslca<br>cd sslca<br>sudo cp /usr/local/ssl/ssl/misc -r ./<br>sudo cp /usr/local/ssl/ssl/openssl.cnf ./misc<br>cd misc<br>sudo CA.sh –newca<br>//产生一个demoCA文件夹<br>cd demoCA<br>//复制安装目录下面的openssl.cnf文件到demoCA下<br>sudo cp /usr/local/ssl/ssl/openssl.cnf ./<br>//产生CA自签名证书<br>openssl genrsa -out ./private/ca.key -rand ./private/.rnd -des 2048<br>openssl req -new -x509 -days 3650 -key ./private/ca.key -out ./private/ca.crt -config openssl.cnf<br>openssl x509 -in ./private/ca.crt -noout -text<br>//产生server的证书过程<br>openssl genrsa -out ./private/server.key 1024<br>openssl req -new -key ./private/server.key -out ./newcerts/server.csr -config openssl.cnf<br>//这一步如果产生错误，请看后面的解决方法<br>openssl ca -in ./newcerts/server.csr -cert ./private/ca.crt -keyfile ./private/ca.key -config openssl.cnf -policy policy_anything -out ./certs/server.crt<br>openssl x509 -in ./certs/server.crt -noout -text<br>//产生proxy的证书过程<br>openssl genrsa -out ./private/proxy.key 1024<br>//这步要是产生错误，请看后面的解决方法<br>openssl req -new -key ./private/proxy.key -out ./newcerts/proxy.csr -config openssl.cnf<br>openssl ca -in ./newcerts/proxy.csr -cert ./private/ca.crt -keyfile./private/ca.key -config openssl.cnf -policy policy_anything -out ./certs/proxy.crt<br>openssl x509 -in ./certs/proxy.crt -noout -text<br>//产生client的证书过程<br>openssl genrsa -out ./private/client.key 1024<br>openssl req -new -key ./private/client.key -out ./newcerts/client.csr -config openssl.cnf<br>openssl ca -in ./newcerts/client.csr -cert ./private/ca.crt -keyfile ./private/ca.key -config openssl.cnf -policy policy_anything -out ./certs/client.crt<br>openssl x509 -in ./certs/client.crt -noout -text<br></code></pre></td></tr></table></figure>

<p><strong>产生一般错误的解决方法</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">//出现：I am unable to access the ./demoCA/newcerts directory<br>       ./demoCA/newcerts:Nosuch file or directory<br>  解决：修改openssl.cnf<br>  在42行：dir = ./demoCA修改为 dir = ./<br>//出现：failed to update database<br>         TXT_DB error number 2<br>  解决：修改index.txt<br>  将unique_subject = yes修改为 unique_subject = no<br></code></pre></td></tr></table></figure>





<h3 id="正常openssl生成证书"><a href="#正常openssl生成证书" class="headerlink" title="正常openssl生成证书"></a>正常openssl生成证书</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">mkdir ssl<br>cd ssl<br>cp -r /etc/ssl/misc ./<br>cp /etc/ssl/openssl.cnf ./misc<br>sudo ./CA.pl -newca<br>cp /etc/ssl/openssl.cnf ./<br>mkdir private<br>echo &quot;abc&quot; &gt; ./private/.rnd # 随机种子<br>openssl genrsa -out ./private/ca.key -rand ./private/.rnd -des 2048 # 生成私钥，输入两次密码 1234<br>openssl req -new -x509 -days 3650 -key ./private/ca.key -out ./private/ca.crt -config openssl.cnf # 生成证书，输入之前密码1234<br>openssl x509 -in ./private/ca.crt -noout -text # 查看证书<br># 生成server证书<br>openssl genrsa -out ./private/server.key 1024<br>mkdir newcerts<br>openssl req -new -key ./private/server.key -out ./newcerts/server.csr -config openssl.cnf # 生成服务端私钥，输入密码12345<br>mkdir certs<br><br></code></pre></td></tr></table></figure>





<h3 id="客户端的代码"><a href="#客户端的代码" class="headerlink" title="客户端的代码"></a>客户端的代码</h3><p>vim client.c</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-comment">//client </span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;openssl/rand.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;string.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;errno.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;sys/socket.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;resolv.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdlib.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;netinet/in.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;arpa/inet.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;unistd.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;openssl/ssl.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;openssl/err.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;errno.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;curses.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> PORT 7979</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> SERVER <span class="hljs-string">&quot;127.0.0.1&quot;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> CACERT <span class="hljs-string">&quot;./private/ca.crt&quot;</span></span><br><span class="hljs-comment">/* 如果需要与不是本机的服务器通信，在这个地方的证书导入对应服务器的证书，我的是和java通信，所以就导入了java端的服务器证书</span><br><span class="hljs-comment">注意，java端的证书需要进行格式转换，具体操作方法请参见开头的说明。*/</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> MYCERTF <span class="hljs-string">&quot;./certs/proxy.crt&quot;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> MYKEYF <span class="hljs-string">&quot;./private/proxy.key&quot;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> MSGLENGTH 1024</span><br><span class="hljs-type">int</span><br><span class="hljs-title function_">main</span> <span class="hljs-params">()</span><br>&#123;<br><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">sockaddr_in</span> <span class="hljs-title">sin</span>;</span><br><span class="hljs-type">int</span> seed_int[<span class="hljs-number">100</span>];<br>SSL *ssl;<br>SSL_METHOD *meth;<br>SSL_CTX *ctx;<br><span class="hljs-type">int</span> i;<br> <br><span class="hljs-comment">/* 初始化OpenSSL */</span><br>SSL_library_init();<br><span class="hljs-comment">/*加载算法库 */</span><br>OpenSSL_add_ssl_algorithms ();<br><span class="hljs-comment">/*加载错误处理信息 */</span><br>SSL_load_error_strings ();<br><span class="hljs-comment">/* 选择会话协议 */</span><br>meth = (SSL_METHOD *) TLSv1_client_method ();<br><span class="hljs-comment">/* 创建会话环境 */</span><br>ctx = SSL_CTX_new (meth);<br><span class="hljs-keyword">if</span> (<span class="hljs-literal">NULL</span> == ctx)<br><span class="hljs-built_in">exit</span> (<span class="hljs-number">1</span>);<br><span class="hljs-comment">/* 制定证书验证方式 */</span><br>SSL_CTX_set_verify (ctx, SSL_VERIFY_PEER, <span class="hljs-literal">NULL</span>);<br> <br><span class="hljs-comment">/* 为SSL会话加载CA证书*/</span><br>SSL_CTX_load_verify_locations (ctx, CACERT, <span class="hljs-literal">NULL</span>);<br><br><span class="hljs-comment">/* 为SSL会话加载用户证书 */</span><br><span class="hljs-keyword">if</span> (<span class="hljs-number">0</span> == SSL_CTX_use_certificate_file (ctx, MYCERTF, SSL_FILETYPE_PEM))<br>&#123;<br>ERR_print_errors_fp (<span class="hljs-built_in">stderr</span>);<br><span class="hljs-built_in">exit</span> (<span class="hljs-number">1</span>);<br>&#125;<br><span class="hljs-comment">/* 为SSL会话加载用户私钥 */</span><br><span class="hljs-keyword">if</span> (<span class="hljs-number">0</span> == SSL_CTX_use_PrivateKey_file (ctx, MYKEYF, SSL_FILETYPE_PEM))<br>&#123;<br>ERR_print_errors_fp (<span class="hljs-built_in">stderr</span>);<br><span class="hljs-built_in">exit</span> (<span class="hljs-number">1</span>);<br>&#125;<br><span class="hljs-comment">/* 验证私钥和证书是否相符 */</span><br><span class="hljs-keyword">if</span> (!SSL_CTX_check_private_key (ctx))<br>&#123;<br><span class="hljs-built_in">printf</span> (<span class="hljs-string">&quot;Private key does not match the certificate public key\n&quot;</span>);<br><span class="hljs-built_in">exit</span> (<span class="hljs-number">1</span>);<br>&#125;<br><span class="hljs-comment">/* 设置随机数 */</span><br>srand ((<span class="hljs-type">unsigned</span>) time (<span class="hljs-literal">NULL</span>));<br><span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">100</span>; i++)<br>seed_int[i] = rand ();<br>RAND_seed (seed_int, <span class="hljs-keyword">sizeof</span> (seed_int));<br><span class="hljs-comment">/* 指定加密器类型 */</span><br>SSL_CTX_set_cipher_list (ctx, <span class="hljs-string">&quot;RC4-MD5&quot;</span>);<br>SSL_CTX_set_mode (ctx, SSL_MODE_AUTO_RETRY);<br><span class="hljs-type">int</span> sock;<br><span class="hljs-built_in">printf</span> (<span class="hljs-string">&quot;Begin tcp socket...\n&quot;</span>);<br><span class="hljs-comment">/* 创建socket描述符 */</span><br>sock = socket (AF_INET, SOCK_STREAM, <span class="hljs-number">0</span>);<br><span class="hljs-keyword">if</span> (sock == <span class="hljs-number">-1</span>)<br>&#123;<br><span class="hljs-built_in">printf</span> (<span class="hljs-string">&quot;SOCKET error. \n&quot;</span>);<br>&#125;<br><span class="hljs-built_in">memset</span> (&amp;<span class="hljs-built_in">sin</span>, <span class="hljs-string">&#x27;\0&#x27;</span>, <span class="hljs-keyword">sizeof</span> (<span class="hljs-built_in">sin</span>));<br> <br><span class="hljs-comment">/* 准备通信地址和端口号 */</span><br><span class="hljs-built_in">sin</span>.sin_family = AF_INET;<br><span class="hljs-built_in">sin</span>.sin_addr.s_addr = inet_addr (SERVER); <span class="hljs-comment">/* Server IP */</span><br><span class="hljs-built_in">sin</span>.sin_port = htons (PORT); <span class="hljs-comment">/* Server Port number */</span><br><span class="hljs-type">int</span> icnn = connect (sock, (<span class="hljs-keyword">struct</span> sockaddr *) &amp;<span class="hljs-built_in">sin</span>, <span class="hljs-keyword">sizeof</span> (<span class="hljs-built_in">sin</span>));<br><span class="hljs-keyword">if</span> (icnn == <span class="hljs-number">-1</span>)<br>&#123;<br><span class="hljs-built_in">printf</span> (<span class="hljs-string">&quot;can not connect to server,%s\n&quot;</span>, strerror (errno));<br><span class="hljs-built_in">exit</span> (<span class="hljs-number">1</span>);<br>&#125;<br><br> <br><span class="hljs-comment">/* 创建一个SSL套接字*/</span><br>ssl = SSL_new (ctx);<br><span class="hljs-keyword">if</span> (<span class="hljs-literal">NULL</span> == ssl)<br><span class="hljs-built_in">exit</span> (<span class="hljs-number">1</span>);<br><br><span class="hljs-comment">/* 申请一个ssl套接字 */</span><br><span class="hljs-keyword">if</span> (<span class="hljs-number">0</span> &gt;= SSL_set_fd (ssl, sock))<br>&#123;<br><span class="hljs-built_in">printf</span> (<span class="hljs-string">&quot;Attach to Line fail!\n&quot;</span>);<br><span class="hljs-built_in">exit</span> (<span class="hljs-number">1</span>);<br>&#125;<br><span class="hljs-comment">//建立SSL连接</span><br><span class="hljs-type">int</span> k = SSL_connect (ssl);<br><span class="hljs-keyword">if</span> (<span class="hljs-number">0</span> == k)<br>&#123;<br><span class="hljs-built_in">printf</span> (<span class="hljs-string">&quot;%d\n&quot;</span>, k);<br><span class="hljs-built_in">printf</span> (<span class="hljs-string">&quot;SSL connect fail!\n&quot;</span>);<br><span class="hljs-built_in">exit</span> (<span class="hljs-number">1</span>);<br>&#125;<br><span class="hljs-built_in">printf</span> (<span class="hljs-string">&quot;connect to server\n&quot;</span>);<br><span class="hljs-type">char</span> sendmsg[MSGLENGTH] = <span class="hljs-string">&quot;\0&quot;</span>;<br><span class="hljs-type">char</span> revmsg[MSGLENGTH] = <span class="hljs-string">&quot;\0&quot;</span>;<br><span class="hljs-comment">//接收服务器消息</span><br><span class="hljs-type">int</span> err = SSL_read (ssl, revmsg, <span class="hljs-keyword">sizeof</span> (revmsg));<br>revmsg[err] = <span class="hljs-string">&#x27;\0&#x27;</span>;<br><span class="hljs-built_in">printf</span> (<span class="hljs-string">&quot;%s\n&quot;</span>, revmsg);<br><span class="hljs-keyword">while</span> (<span class="hljs-number">1</span>)<br>&#123;<br><span class="hljs-built_in">printf</span> (<span class="hljs-string">&quot;please input the data to send:\n&quot;</span>);<br><span class="hljs-built_in">scanf</span> (<span class="hljs-string">&quot;%s&quot;</span>, sendmsg);<br><span class="hljs-comment">//向服务器发送消息</span><br>SSL_write (ssl, sendmsg, <span class="hljs-built_in">strlen</span> (sendmsg));<br><span class="hljs-built_in">printf</span> (<span class="hljs-string">&quot;send message &#x27; %s &#x27; success\n&quot;</span>, sendmsg);<br>&#125;<br><span class="hljs-comment">//关闭连接</span><br>SSL_shutdown (ssl);<br>SSL_free (ssl);<br>SSL_CTX_free (ctx);<br>close (sock);<br>getch ();<br><span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure>

<h3 id="服务端的代码"><a href="#服务端的代码" class="headerlink" title="服务端的代码"></a>服务端的代码</h3><p>vim server.c</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-comment">//server </span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;openssl/x509.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;openssl/ssl.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;openssl/err.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdlib.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;errno.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;string.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;sys/types.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;netinet/in.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;sys/socket.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;sys/wait.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;unistd.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;arpa/inet.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;openssl/ssl.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;openssl/err.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;curses.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> MSGLENGTH 1024</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> PORT 7979</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> CACERT <span class="hljs-string">&quot;./private/ca.crt&quot;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> SVRCERTF <span class="hljs-string">&quot;./certs/server.crt&quot;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> SVRKEYF <span class="hljs-string">&quot;./private/server.key&quot;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> ADDRESS “127.0.0.1”</span><br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span> <span class="hljs-params">()</span><br>&#123;<br><span class="hljs-type">int</span> sock;<br>SSL_METHOD *meth;<br>SSL_CTX *ctx;<br>SSL *ssl;<br><span class="hljs-comment">//SSL初库始化</span><br>SSL_library_init();<br><span class="hljs-comment">//载入所有SSL算法</span><br>OpenSSL_add_ssl_algorithms ();<br><span class="hljs-comment">//载入所有错误信息</span><br>SSL_load_error_strings ();<br>meth = (SSL_METHOD *) TLSv1_server_method ();<br>ctx = SSL_CTX_new (meth);<br><span class="hljs-keyword">if</span> (<span class="hljs-literal">NULL</span> == ctx)<br><span class="hljs-built_in">exit</span> (<span class="hljs-number">1</span>);<br>SSL_CTX_set_verify (ctx, SSL_VERIFY_PEER, <span class="hljs-literal">NULL</span>);<br>SSL_CTX_load_verify_locations (ctx, CACERT, <span class="hljs-literal">NULL</span>);<br><span class="hljs-comment">//加载证书和私钥</span><br><span class="hljs-keyword">if</span> (<span class="hljs-number">0</span> == SSL_CTX_use_certificate_file (ctx, SVRCERTF, SSL_FILETYPE_PEM))<br>&#123;<br>ERR_print_errors_fp (<span class="hljs-built_in">stderr</span>);<br><span class="hljs-built_in">exit</span> (<span class="hljs-number">1</span>);<br>&#125;<br><span class="hljs-keyword">if</span> (<span class="hljs-number">0</span> == SSL_CTX_use_PrivateKey_file (ctx, SVRKEYF, SSL_FILETYPE_PEM))<br>&#123;<br>ERR_print_errors_fp (<span class="hljs-built_in">stderr</span>);<br><span class="hljs-built_in">exit</span> (<span class="hljs-number">1</span>);<br>&#125;<br><span class="hljs-keyword">if</span> (!SSL_CTX_check_private_key (ctx))<br>&#123;<br><span class="hljs-built_in">printf</span> (<span class="hljs-string">&quot;Private key does not match the certificate public key\n&quot;</span>);<br><span class="hljs-built_in">exit</span> (<span class="hljs-number">1</span>);<br>&#125;<br>SSL_CTX_set_cipher_list (ctx, <span class="hljs-string">&quot;RC4-MD5&quot;</span>);<br>SSL_CTX_set_mode (ctx, SSL_MODE_AUTO_RETRY);<br><span class="hljs-built_in">printf</span> (<span class="hljs-string">&quot;Begin tcp socket...\n&quot;</span>);<br>sock = socket (AF_INET, SOCK_STREAM, <span class="hljs-number">0</span>);<br><span class="hljs-keyword">if</span> (sock == <span class="hljs-number">-1</span>)<br>&#123;<br><span class="hljs-built_in">printf</span> (<span class="hljs-string">&quot;SOCKET error! \n&quot;</span>);<br><span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br><span class="hljs-comment">//准备通信地址和端口号</span><br><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">sockaddr_in</span> <span class="hljs-title">addr</span>;</span><br><span class="hljs-built_in">memset</span> (&amp;addr, <span class="hljs-string">&#x27;\0&#x27;</span>, <span class="hljs-keyword">sizeof</span> (addr));<br>addr.sin_family = AF_INET;<br>addr.sin_port = htons (PORT); <span class="hljs-comment">/* Server Port number */</span><br><span class="hljs-comment">//addr.sin_addr.s_addr = INADDR_ANY;</span><br>addr.sin_addr.s_addr = inet_addr(ADDRESS);<br><span class="hljs-comment">//绑定地址和端口号</span><br><span class="hljs-type">int</span> nResult = bind (sock, (<span class="hljs-keyword">struct</span> sockaddr *) &amp;addr, <span class="hljs-keyword">sizeof</span> (addr));<br><span class="hljs-keyword">if</span> (nResult == <span class="hljs-number">-1</span>)<br>&#123;<br><span class="hljs-built_in">printf</span> (<span class="hljs-string">&quot;bind socket error\n&quot;</span>);<br><span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br><span class="hljs-built_in">printf</span> (<span class="hljs-string">&quot;server start successfully,port:%d\nwaiting for connections\n&quot;</span>,<br>PORT);<br><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">sockaddr_in</span> <span class="hljs-title">sa_cli</span>;</span><br><span class="hljs-comment">//设置最大连接数</span><br><span class="hljs-type">int</span> err = listen (sock, <span class="hljs-number">5</span>);<br><span class="hljs-keyword">if</span> (<span class="hljs-number">-1</span> == err)<br><span class="hljs-built_in">exit</span> (<span class="hljs-number">1</span>);<br><span class="hljs-type">int</span> client_len = <span class="hljs-keyword">sizeof</span> (sa_cli);<br><span class="hljs-comment">//等待客户端连接</span><br><span class="hljs-type">int</span> ss = accept (sock, (<span class="hljs-keyword">struct</span> sockaddr *) &amp;sa_cli, &amp;client_len);<br><span class="hljs-keyword">if</span> (ss == <span class="hljs-number">-1</span>)<br>&#123;<br><span class="hljs-built_in">exit</span> (<span class="hljs-number">1</span>);<br>&#125;<br>close (sock);<br><span class="hljs-built_in">printf</span> (<span class="hljs-string">&quot;Connection from %d, port %d\n&quot;</span>, sa_cli.sin_addr.s_addr,<br>sa_cli.sin_port);<br>ssl = SSL_new (ctx);<br><span class="hljs-keyword">if</span> (<span class="hljs-literal">NULL</span> == ssl)<br><span class="hljs-built_in">exit</span> (<span class="hljs-number">1</span>);<br><span class="hljs-keyword">if</span> (<span class="hljs-number">0</span> == SSL_set_fd (ssl, ss))<br>&#123;<br><span class="hljs-built_in">printf</span> (<span class="hljs-string">&quot;Attach to Line fail!\n&quot;</span>);<br><span class="hljs-built_in">exit</span> (<span class="hljs-number">1</span>);<br>&#125;<br><span class="hljs-type">int</span> k = SSL_accept (ssl);<br><span class="hljs-keyword">if</span> (<span class="hljs-number">0</span> == k)<br>&#123;<br><span class="hljs-built_in">printf</span> (<span class="hljs-string">&quot;%d/n&quot;</span>, k);<br><span class="hljs-built_in">printf</span> (<span class="hljs-string">&quot;SSL connect fail!\n&quot;</span>);<br><span class="hljs-built_in">exit</span> (<span class="hljs-number">1</span>);<br>&#125;<br>X509 *client_cert;<br>client_cert = SSL_get_peer_certificate (ssl);<br><span class="hljs-built_in">printf</span> (<span class="hljs-string">&quot;find a customer to try to connect\n&quot;</span>);<br><span class="hljs-keyword">if</span> (client_cert != <span class="hljs-literal">NULL</span>)<br>&#123;<br><span class="hljs-built_in">printf</span> (<span class="hljs-string">&quot;Client certificate:\n&quot;</span>);<br><span class="hljs-type">char</span> *str =<br>X509_NAME_oneline (X509_get_subject_name (client_cert), <span class="hljs-number">0</span>, <span class="hljs-number">0</span>);<br><span class="hljs-keyword">if</span> (<span class="hljs-literal">NULL</span> == str)<br>&#123;<br><span class="hljs-built_in">printf</span> (<span class="hljs-string">&quot;auth error!\n&quot;</span>);<br><span class="hljs-built_in">exit</span> (<span class="hljs-number">1</span>);<br>&#125;<br><span class="hljs-built_in">printf</span> (<span class="hljs-string">&quot;subject: %s\n&quot;</span>, str);<br>str = X509_NAME_oneline (X509_get_issuer_name (client_cert), <span class="hljs-number">0</span>, <span class="hljs-number">0</span>);<br><span class="hljs-keyword">if</span> (<span class="hljs-literal">NULL</span> == str)<br>&#123;<br><span class="hljs-built_in">printf</span> (<span class="hljs-string">&quot;certificate name is null\n&quot;</span>);<br><span class="hljs-built_in">exit</span> (<span class="hljs-number">1</span>);<br>&#125;<br><span class="hljs-built_in">printf</span> (<span class="hljs-string">&quot;issuer: %s\n&quot;</span>, str);<br><span class="hljs-built_in">printf</span> (<span class="hljs-string">&quot;connect successfully\n&quot;</span>);<br>X509_free (client_cert);<br>OPENSSL_free (str);<br>&#125;<br><span class="hljs-keyword">else</span><br>&#123;<br><span class="hljs-built_in">printf</span> (<span class="hljs-string">&quot;can not find the customer&#x27;s certificate\n&quot;</span>);<br><span class="hljs-built_in">exit</span> (<span class="hljs-number">1</span>);<br>&#125;<br><span class="hljs-type">char</span> buf[MSGLENGTH];<br>SSL_write (ssl, <span class="hljs-string">&quot;Server is connect to you!\n&quot;</span>,<br><span class="hljs-built_in">strlen</span> (<span class="hljs-string">&quot;Server is connect to you!\n&quot;</span>));<br><span class="hljs-built_in">printf</span> (<span class="hljs-string">&quot;Listen to the client: \n&quot;</span>);<br><span class="hljs-keyword">while</span> (<span class="hljs-number">1</span>)<br>&#123;<br>err = SSL_read (ssl, buf, <span class="hljs-keyword">sizeof</span> (buf));<br>buf[err] = <span class="hljs-string">&#x27;\0&#x27;</span>;<br><span class="hljs-built_in">printf</span> (<span class="hljs-string">&quot;%s\n&quot;</span>, buf);<br>&#125;<br>SSL_shutdown (ssl);<br>SSL_free (ssl);<br>SSL_CTX_free (ctx);<br>getch ();<br><span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure>



<p>makefile的代码:</p>
<p>vim makefile</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">all:client.c server.c<br>       gcc –o clientclient.c –Wall –lssl –ldl -lcurses<br>       gcc –o serverserver.c –Wall –lssl –ldl –lcurses<br>       #如果是自定义安装路径的，可以使用下面的<br>#gcc -Wall -o clientclient.c -I/usr/openssl-1.0.0c/include/usr/openssl-1.0.0c/libssl.a /usr/openssl-1.0.0c/libcrypto.a –ldl<br>#gcc -Wall -o serverserver.c -I/usr/openssl-1.0.0c/include/usr/openssl-1.0.0c/libssl.a /usr/openssl-1.0.0c/libcrypto.a -ldl<br>clean::<br>rm -f client server<br></code></pre></td></tr></table></figure>



<p>参考工具：</p>
<p>证书格式转换：<a target="_blank" rel="noopener" href="https://www.sslshopper.com/ssl-converter.html">https://www.sslshopper.com/ssl-converter.html</a></p>
<div id="paginator"></div></div><div id="post-footer"><div id="pages"><div id="footer-link" style="right: calc(50% - 1px);order: 1;border-right: 1px solid #fe2;padding-left: unset;max-width: calc(50% - 4px);"><a href="/2021/05/26/dev/language/go/go-pro/">← Next go工程</a></div><div id="footer-link" style="left: 50%;order: 0;border-left: 1px solid #fe2;padding-right: unset;max-width: calc(50% - 5px);"><a href="/2021/05/19/security/school/sqli/">SQLI实验 Prev →</a></div></div></div><details id="reward"><summary>打赏点小钱</summary><div id="alipay"><span>支付宝 | Alipay</span><br><img src="/img/Alipay.png"></div><div id="wechat"><span>微信 | WeChat</span><br><img src="/img/WeChat.png"></div></details><div id="Valine"></div></div><div id="bottom-btn"><a id="to-index" href="#toc-div" title="index">≡</a><a id="to-top" onClick="scrolls.scrolltop();" title="to top" style="opacity: 0; display: none;">∧</a></div></article><aside><div id="aside-top"><div id="about"><a href="/" id="logo"><img src="/images/header.jpg" alt="Logo"></a><h1 id="Dr"><a target="_blank" rel="noopener" href="https://github.com/i0gan">I0gan</a></h1><div id="description"></div></div><div id="aside-block"><div id="toc-div"><h1>INDEX</h1><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#https-c%E8%AF%AD%E8%A8%80%E5%AE%9E%E7%8E%B0%E5%8F%8C%E5%90%91%E8%AE%A4%E8%AF%81"><span class="toc-text">https c语言实现双向认证</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%AD%A3%E5%B8%B8openssl%E7%94%9F%E6%88%90%E8%AF%81%E4%B9%A6"><span class="toc-text">正常openssl生成证书</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%A2%E6%88%B7%E7%AB%AF%E7%9A%84%E4%BB%A3%E7%A0%81"><span class="toc-text">客户端的代码</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9C%8D%E5%8A%A1%E7%AB%AF%E7%9A%84%E4%BB%A3%E7%A0%81"><span class="toc-text">服务端的代码</span></a></li></ol></li></ol></li></ol></div></div></div><footer><nobr><span class="text-title">ICP</span><a class="text-content" target="_blank" rel="noopener" href="https://beian.miit.gov.cn/">沪ICP备2021037250号-1  </a></nobr><nobr><span class="text-title">©</span><span class="text-content">2022 by i0gan</span></nobr><br></footer></aside></main><canvas id="canvas-dust"></canvas><div id="cursor-container"><div id="cursor-outer"></div><div id="cursor-effect"></div></div><script src="/js/search.js"></script><script class="pjax-js">reset=_=>{new Valine({
 el: '#Valine'
 , appId: 'TzNey4n3v0Sx6vdBbytYLoH9-gzGzoHsz'
 , appKey: 'GIXXrK9zLxt0bZLww1hte0Oq' , placeholder: '此条评论委托企鹅物流发送'
});code.findCode();mermaid.init(undefined, ('.mermaid'));}</script><script src="//unpkg.com/@highlightjs/cdn-assets@11.4.0/highlight.min.js"></script><script src="/js/arknights.js"></script><script>window.addEventListener("load",()=>{reset()})</script></body></html>