<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Android 逆向入门 | Hexo</title><script src="//unpkg.com/valine/dist/Valine.min.js"></script><script>var config = {"root":"/","path":""}</script><script src="//unpkg.com/mermaid@8.13.5/dist/mermaid.min.js"></script><script>mermaid.initialize({
 startOnLoad: true
 , theme: 'dark'
});</script><link rel="stylesheet" href="/css/arknights.css"><link rel="stylesheet" href="//unpkg.com/@highlightjs/cdn-assets@11.4.0/styles/atom-one-dark-reasonable.min.css"><style>@font-face {
 font-family: BenderLight;
 src: local('Bender'), url("/font/BenderLight.ttf");
}
@font-face {
 font-family: 'JetBrains Mono';
 src: local('JetBrains Mono'), url('/font/JetBrainsMono-Regular.woff2') format('woff2');
}</style><meta name="generator" content="Hexo 6.3.0"></head><body style="background-image:url(https://ak.hypergryph.com/assets/index/images/ak/pc/bk.jpg);"><main><header class="closed"><nav><div class="navBtn"><i class="navBtnIcon"><span class="navBtnIconBar"></span><span class="navBtnIconBar"></span><span class="navBtnIconBar"></span></i></div><ol class="navContent"><li class="navItem" id="search-header"><span class="navItemTitle"><input autocomplete="off" autocorrect="off" autocapitalize="none" placeholder="数据检索" spellcheck="false" maxlength="50" type="text" id="search-input"></span></li><li class="navItem"><a class="navBlock" href="/"><span class="navItemTitle">Home</span></a></li><li class="navItem" matchdata="categories,tags"><a class="navBlock" href="/archives/"><span class="navItemTitle">Archives</span></a></li><li class="navItem"><a class="navBlock" href="/demo/"><span class="navItemTitle">独立页面</span></a></li></ol></nav><div class="search-popup"><div id="search-result"></div></div></header><article><div id="post-bg"><div id="post-title"><h1>Android 逆向入门</h1><div id="post-info"><span>First Post: <div class="control"><time datetime="2020-09-07T08:36:01.000Z" id="date"> 2020-09-07</time></div></span><br><span>Last Update: <div class="control"><time datetime="2022-04-30T13:54:31.470Z" id="updated"> 2022-04-30</time></div></span><br><span>Word Count: <div class="control">3.1k</div></span><br><span>Read Time: <div class="control">17 min</div></span></div></div><hr><div id="post-content"><h1 id="Android-Re-入门"><a href="#Android-Re-入门" class="headerlink" title="Android Re 入门"></a>Android Re 入门</h1><h2 id="必备工具"><a href="#必备工具" class="headerlink" title="必备工具:"></a>必备工具:</h2><p>IDA : 反编译.so文件</p>
<p>AndroidKiller: 反编译apk文件及再次编译为apk</p>
<p>jd-gui  : 将.jar文件反编译为java代码</p>
<p>dex2jar: 反编译.dex文件</p>
<p>apktool: 能够反编译及回编译apk</p>
<p>夜神模拟器: 运行apk文件</p>
<h2 id="例题-1-easy-so"><a href="#例题-1-easy-so" class="headerlink" title="例题 1 [easy-so]"></a>例题 1 [easy-so]</h2><p><a target="_blank" rel="noopener" href="https://adworld.xctf.org.cn/media/task/attachments/456c1dab04b24036ba1d6e32a08dc882.apk">下载</a></p>
<p>来源:攻防世界</p>
<p>使用夜神模拟器运行该apk文件, 发现需要输入flag</p>
<p>zip解压apk文件, 用 dex2jar反编译 classes.dex文件得到classes-dex2jar.jar,</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">d2j-dex2jar.bat classes.dex<br></code></pre></td></tr></table></figure>

<p> 再用jd-gui打开classes-dex2jar.jar反编译为java代码.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MainActivity</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">AppCompatActivity</span> &#123;<br>  <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onCreate</span><span class="hljs-params">(Bundle paramBundle)</span> &#123;<br>    <span class="hljs-built_in">super</span>.onCreate(paramBundle);<br>    setContentView(<span class="hljs-number">2131296283</span>);<br>    ((Button)findViewById(<span class="hljs-number">2131165218</span>)).setOnClickListener(<span class="hljs-keyword">new</span> <span class="hljs-title class_">View</span>.OnClickListener() &#123;<br>          <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onClick</span><span class="hljs-params">(View param1View)</span> &#123;<br>            <span class="hljs-keyword">if</span> (cyberpeace.CheckString(((EditText)MainActivity.<span class="hljs-built_in">this</span>.findViewById(<span class="hljs-number">2131165233</span>)).getText().toString()) == <span class="hljs-number">1</span>) &#123;<br>              Toast.makeText((Context)MainActivity.<span class="hljs-built_in">this</span>, <span class="hljs-string">&quot;, 1).show();</span><br><span class="hljs-string">              return;</span><br><span class="hljs-string">            &#125; </span><br><span class="hljs-string">            Toast.makeText((Context)MainActivity.this, &quot;</span>, <span class="hljs-number">1</span>).show();<br>          &#125;<br>        &#125;);<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>在这里可以发现, cyberpeace加载了’cyberpeace’动态库, CheckString函数是native层的, 这个函数的实现就在libcyberpeace.so文件中</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">package com.testjava.jack.pingan2;<br><br>public class cyberpeace &#123;<br>  static &#123;<br>    System.loadLibrary(&quot;cyberpeace&quot;);<br>  &#125;<br>  <br>  public static native int CheckString(String paramString);<br>&#125;<br><br></code></pre></td></tr></table></figure>

<p>使用ida打开lib&#x2F;x86&#x2F;libcyberpeace.so文件, 找到 _BOOL4 __cdecl Java_com_testjava_jack_pingan2_cyberpeace_CheckString(int a1, int a2, int a3)函数, 该函数实现如下:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">_BOOL4 __cdecl Java_com_testjava_jack_pingan2_cyberpeace_CheckString(int a1, int a2, int a3)<br>&#123;<br>  const char *get_str; // ST1C_4<br>  size_t len; // edi<br>  char *str; // esi<br>  size_t i; // edi<br>  char v7; // al<br>  char v8; // al<br>  size_t v9; // edi<br>  char v10; // al<br><br>  get_str = (const char *)(*(int (__cdecl **)(int, int, _DWORD))(*(_DWORD *)a1 + 676))(a1, a3, 0); // 从java层获取所输入的字符串<br>  len = strlen(get_str);<br>  str = (char *)malloc(len + 1);<br>  memset(&amp;str[len], 0, len != -1);<br>  memcpy(str, get_str, len);<br>  if ( strlen(str) &gt;= 2 ) // 加密1<br>  &#123;<br>    i = 0;<br>    do<br>    &#123;<br>      v7 = str[i];<br>      str[i] = str[i + 16];<br>      str[i++ + 16] = v7;<br>    &#125;<br>    while ( i &lt; strlen(str) &gt;&gt; 1 );<br>  &#125;<br>  // 加密2<br>  v8 = *str;<br>  if ( *str )<br>  &#123;<br>    *str = str[1];<br>    str[1] = v8;<br>    if ( strlen(str) &gt;= 3 )<br>    &#123;<br>      v9 = 2;<br>      do<br>      &#123;<br>        v10 = str[v9];<br>        str[v9] = str[v9 + 1];<br>        str[v9 + 1] = v10;<br>        v9 += 2;<br>      &#125;<br>      while ( v9 &lt; strlen(str) );<br>    &#125;<br>  &#125;<br>  return strcmp(str, &quot;f72c5a36569418a20907b55be5bf95ad&quot;) == 0; // 与字符串作比较<br>&#125;<br></code></pre></td></tr></table></figure>

<p>从以上发现, 对我们所输入的字符串进行了加密, 然后再与f72c5a36569418a20907b55be5bf95ad进行比较. 现在只需逆一下以上代码即可得到flag, exp代码如下</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">#include &lt;stdio.h&gt;<br>#include &lt;string.h&gt;<br><br>int main(void) &#123;<br>	char str[] = &quot;f72c5a36569418a20907b55be5bf95ad&quot;;<br>	int i, v7, v8, v9, v10;<br>	v8 = *str;<br>	if ( *str ) &#123;<br>		*str = str[1];<br>		str[1] = v8;<br>		if ( strlen(str) &gt;= 3 ) &#123;<br>      		v9 = 2;<br>      		do &#123;<br>        		v10 = str[v9];<br>        		str[v9] = str[v9 + 1];<br>        		str[v9 + 1] = v10;<br>        		v9 += 2;<br>      		&#125; while ( v9 &lt; strlen(str) );<br>		&#125;<br>	&#125;<br>	<br>	// 交换 <br>	if ( strlen(str) &gt;= 2 )	&#123;<br>   	 i = 0;<br>    	do &#123;<br>      		v7 = str[i];<br>      		str[i] = str[i + 16];<br>     		str[i++ + 16] = v7;<br>   	 	&#125; while ( i &lt; strlen(str) &gt;&gt; 1 );<br>	&#125;<br>	printf(&quot;%s&quot;, str);<br>  <br>	return 0;<br>&#125;<br><br></code></pre></td></tr></table></figure>

<p>运行以上代码即可获取flag</p>
<h1 id="例题-2-app2"><a href="#例题-2-app2" class="headerlink" title="例题 2 [app2]"></a>例题 2 [app2]</h1><p><a target="_blank" rel="noopener" href="https://adworld.xctf.org.cn/task/answer?type=mobile&number=6&grade=0&id=5086&page=1">下载</a></p>
<p>来源:攻防世界</p>
<p>对输入的账号和密码在SecondActivity类中进行加密判断, 而加密调用了native层的加密函数</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">protected void onCreate(Bundle paramBundle) &#123;<br>    super.onCreate(paramBundle);<br>    setContentView(2130903041);<br>    Intent intent = getIntent();<br>    String str1 = intent.getStringExtra(&quot;ili&quot;);<br>    String str2 = intent.getStringExtra(&quot;lil&quot;);<br>    if (Encryto.doRawData(this, str1 + str2).equals(&quot;VEIzd/V2UPYNdn/bxH3Xig==&quot;)) &#123;<br>      intent.setAction(&quot;android.test.action.MoniterInstallService&quot;);<br>      intent.setClass((Context)this, MoniterInstallService.class);<br>      intent.putExtra(&quot;company&quot;, &quot;tencent&quot;);<br>      intent.putExtra(&quot;name&quot;, &quot;hacker&quot;);<br>      intent.putExtra(&quot;age&quot;, 18);<br>      startActivity(intent);<br>      startService(intent);<br>    &#125; <br>    SharedPreferences.Editor editor = getSharedPreferences(&quot;test&quot;, 0).edit();<br>    editor.putString(&quot;ilil&quot;, str1);<br>    editor.putString(&quot;lili&quot;, str2);<br>    editor.commit();<br>  &#125;<br></code></pre></td></tr></table></figure>

<p>IDA反编译doRawData函数, 因为a为对象, 选择a按下y 键 然后输入 JNIEnv*就可以显示对象的函数调用, 如下</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">int __cdecl doRawData(JNIEnv *a1, int a2, int a3, int a4)<br>&#123;<br>  char *v4; // esi<br>  const char *v5; // ST10_4<br>  int result; // eax<br>  char *v7; // esi<br>  jstring (*v8)(JNIEnv *, const jchar *, jsize); // ST10_4<br>  size_t v9; // eax<br>  int v10; // [esp+4h] [ebp-28h]<br>  int v11; // [esp+8h] [ebp-24h]<br>  int v12; // [esp+Ch] [ebp-20h]<br>  int v13; // [esp+10h] [ebp-1Ch]<br>  char v14; // [esp+14h] [ebp-18h]<br>  unsigned int v15; // [esp+18h] [ebp-14h]<br><br>  v15 = __readgsdword(0x14u);<br>  if ( checkSignature((int)a1, a2, a3) == 1 )<br>  &#123;<br>    v14 = 0;<br>    v13 = 0x3D3D7965;<br>    v12 = 0x6B747365;<br>    v11 = 0x74617369;<br>    v10 = 0x73696874;<br>    v4 = (char *)(*a1)-&gt;GetStringUTFChars(a1, (jstring)a4, 0);<br>    v5 = (const char *)AES_128_ECB_PKCS5Padding_Encrypt(v4, (int)&amp;v10);<br>    (*a1)-&gt;ReleaseStringUTFChars(a1, (jstring)a4, v4);<br>    result = (int)(*a1)-&gt;NewStringUTF(a1, v5);<br>  &#125;<br>  else<br>  &#123;<br>    v7 = UNSIGNATURE[0];<br>    v8 = (*a1)-&gt;NewString;<br>    v9 = strlen(UNSIGNATURE[0]);<br>    result = (int)v8(a1, (const jchar *)v7, v9);<br>  &#125;<br>  return result;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>可以发现, 加密方式为aes加密, key 为 v10中的内容.为thisisatestkey&#x3D;&#x3D;</p>
<p>对VEIzd&#x2F;V2UPYNdn&#x2F;bxH3Xig&#x3D;&#x3D; 解密为aimagetencent, 发现提交flag错误, 重新找另一个字符串,在FileDataActivity类中找到如下.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">public class FileDataActivity extends a &#123;<br>  private TextView c;<br>  <br>  protected void onCreate(Bundle paramBundle) &#123;<br>    super.onCreate(paramBundle);<br>    setContentView(2130903042);<br>    this.c = (TextView)findViewById(2131165184);<br>    this.c.setText(Encryto.decode(this, &quot;9YuQ2dk8CSaCe7DTAmaqAA==&quot;));<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>调用了decode函数, 而decode函数与doRawData实现一样, 直接与之前一样的AES ecb解密, 得到flag</p>
<h1 id="Ph0en1x-100"><a href="#Ph0en1x-100" class="headerlink" title="Ph0en1x-100"></a>Ph0en1x-100</h1><p><a target="_blank" rel="noopener" href="https://adworld.xctf.org.cn/media/task/attachments/f6adc401d0eb472892a4ac4481f76a85.apk">下载</a></p>
<p>来源:攻防世界</p>
<p>程序流程, 输入flag</p>
<p>jd-gui反编译如下:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">public void onGoClick(View paramView)<br> &#123;<br>   paramView = this.etFlag.getText().toString();<br>   if (getSecret(getFlag()).equals(getSecret(encrypt(paramView)))) &#123;<br>     Toast.makeText(this, &quot;Success&quot;, 1).show();<br>   &#125;<br>   for (;;)<br>   &#123;<br>     return;<br>     Toast.makeText(this, &quot;Failed&quot;, 1).show();<br>   &#125;<br> &#125;<br></code></pre></td></tr></table></figure>

<p>getFlag函数与encrypt函数是native层</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">static<br>&#123;<br>  System.loadLibrary(&quot;phcm&quot;);<br>&#125;<br><br>public native String encrypt(String paramString);<br><br>public native String getFlag();<br></code></pre></td></tr></table></figure>



<p>反编译libphcm.so文件</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">int __cdecl Java_com_ph0en1x_android_1crackme_MainActivity_encrypt(JNIEnv *a1, int a2, int a3)<br>&#123;<br>  size_t i; // esi<br>  const char *s; // edi<br><br>  i = 0;<br>  for ( s = (*a1)-&gt;GetStringUTFChars(a1, (jstring)a3, 0); i &lt; strlen(s); --s[i++] )<br>    ;<br>  return (*a1)-&gt;NewStringUTF(a1, s);<br>&#125;<br></code></pre></td></tr></table></figure>

<p>以上加密就是对字符串中的每个字符-1</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">int __cdecl Java_com_ph0en1x_android_1crackme_MainActivity_getFlag(JNIEnv *a1)<br>&#123;<br>  signed int v1; // esi<br>  char *v2; // edi<br>  char v3; // al<br>  int result; // eax<br>  int v5; // [esp+26h] [ebp-46h]<br>  int v6; // [esp+2Ah] [ebp-42h]<br>  int v7; // [esp+2Eh] [ebp-3Eh]<br>  __int16 v8; // [esp+32h] [ebp-3Ah]<br>  int v9; // [esp+34h] [ebp-38h]<br>  int v10; // [esp+38h] [ebp-34h]<br>  int v11; // [esp+3Ch] [ebp-30h]<br>  int v12; // [esp+40h] [ebp-2Ch]<br>  int v13; // [esp+44h] [ebp-28h]<br>  int v14; // [esp+48h] [ebp-24h]<br>  int v15; // [esp+4Ch] [ebp-20h]<br>  int v16; // [esp+50h] [ebp-1Ch]<br>  int v17; // [esp+54h] [ebp-18h]<br>  int v18; // [esp+58h] [ebp-14h]<br>  unsigned int v19; // [esp+5Ch] [ebp-10h]<br><br>  v1 = 38;<br>  v2 = (char *)&amp;v18 + 2;<br>  v9 = 1279407662;<br>  v10 = 987807583;<br>  v19 = __readgsdword(0x14u);<br>  v11 = 1663091624;<br>  v12 = 482391945;<br>  v13 = 683820061;<br>  v14 = 235072895;<br>  v15 = 2559534685;<br>  v16 = 382777269;<br>  v17 = 4227367757;<br>  v18 = 4670209;<br>  v5 = 1819043144;<br>  v6 = 1750081647;<br>  v7 = 829318448;<br>  v8 = 120;<br>  do<br>  &#123;<br>    v3 = *v2--;<br>    v2[1] = (*((_BYTE *)&amp;v5 + v1-- % 13) ^ (v3 + 1 - *v2)) - 1;<br>  &#125;<br>  while ( v1 );<br>  LOBYTE(v9) = (v9 ^ 0x48) - 1;<br>  result = (int)(*a1)-&gt;NewStringUTF(a1, (const char *)&amp;v9);<br>  if ( __readgsdword(0x14u) != v19 )<br>    sub_4B0();<br>  return result;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>这个加密稍微有点复杂. 若想获取flag, 先对上面这给逆出来, 在对encrypt加密加密函数给再逆出来即可获得flag, 但是, 我写了一个c脚本, 上面这个有问题, 主要是LOBYTE(v9) &#x3D; (v9 ^ 0x48) - 1;这个语句不好写.换另一种思路.动态调试(瞎弄半天, 啥也没弄出来), 再换另一种, 就是使用Android killer修改smali源码, 将其getFlag函数的字符串给打印出来, 只需将打印失败逻辑添加一下getFlag函数, 将getFlag字符串覆盖为打印失败的字符串, 复制上面调用getFlag的即可, 再更变一下变量, 如下</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">.line 37<br>   :cond_0<br>   const-string v1, &quot;Failed&quot;<br>   <br>   invoke-virtual &#123;p0&#125;, Lcom/ph0en1x/android_crackme/MainActivity;-&gt;getFlag()Ljava/lang/String;<br><br>   move-result-object v1   // getFlag()函数的返回值,(字符串)<br>   <br>   invoke-static &#123;p0, v1, v3&#125;, Landroid/widget/Toast;-&gt;makeText(Landroid/content/Context;Ljava/lang/CharSequence;I)Landroid/widget/Toast;<br><br>   move-result-object v1<br><br>   invoke-virtual &#123;v1&#125;, Landroid/widget/Toast;-&gt;show()V<br></code></pre></td></tr></table></figure>

<p>然后点击Android-&gt;编译, 即可再次编译为apk文件, 安装再nox中运行, 随便输入就会出现ek<code>fz@q2^x/t^fn0mF^6/^rb</code>qanqntfg^E&#96;hq|</p>
<p>再次让每个字符+1就可得到flag</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">#include &lt;stdio.h&gt;<br>#include &lt;string.h&gt;<br><br>int main(void) &#123;<br>	char flag[] = &quot;ek`fz@q2^x/t^fn0mF^6/^rb`qanqntfg^E`hq|&quot;;<br>	for(int i = 0; i &lt; strlen(flag); ++i) &#123;<br>		putchar(++flag[i]);<br>	&#125;<br><br>	return 0;<br>&#125;<br></code></pre></td></tr></table></figure>



<h1 id="app1"><a href="#app1" class="headerlink" title="app1"></a>app1</h1><p><a target="_blank" rel="noopener" href="https://adworld.xctf.org.cn/media/task/attachments/b9af8dfef6b749d2819ef5be16c26a0d.apk">下载</a></p>
<p>来源:攻防世界</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">public void onClick(View paramView)<br> &#123;<br>   for (;;)<br>   &#123;<br>     try<br>     &#123;<br>       str = this.this$0.text.getText().toString();<br>       PackageInfo localPackageInfo = this.this$0.getPackageManager().getPackageInfo(&quot;com.example.yaphetshan.tencentgreat&quot;, 16384);<br>       paramView = localPackageInfo.versionName;<br>       int i = localPackageInfo.versionCode;<br>       j = 0;<br>       if ((j &gt;= str.length()) || (j &gt;= paramView.length())) &#123;<br>         continue;<br>       &#125;<br>       if (str.charAt(j) != (paramView.charAt(j) ^ i))<br>       &#123;<br>         Toast.makeText(this.this$0, &quot;再接再励~&quot;, 1).show();<br>         return;<br>       &#125;<br>     &#125;<br>     catch (PackageManager.NameNotFoundException paramView)<br>     &#123;<br>       String str;<br>       int j;<br>       Toast.makeText(this.this$0, &quot;不要玩小聪明&quot;, 1).show();<br>       continue;<br>     &#125;<br>     j++;<br>     continue;<br>     if (str.length() != paramView.length()) &#123;<br>       continue;<br>     &#125;<br>     Toast.makeText(this.this$0, &quot;恭喜开启芝麻之门&quot;, 1).show();<br>   &#125;<br> &#125;<br></code></pre></td></tr></table></figure>



<p>在BuildConfig class中找到versionName和versionCode</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">package com.example.yaphetshan.tencentgreat;<br><br>public final class BuildConfig<br>&#123;<br>  public static final String APPLICATION_ID = &quot;com.example.yaphetshan.tencentgreat&quot;;<br>  public static final String BUILD_TYPE = &quot;debug&quot;;<br>  public static final boolean DEBUG = Boolean.parseBoolean(&quot;true&quot;);<br>  public static final String FLAVOR = &quot;&quot;;<br>  public static final int VERSION_CODE = 15;<br>  public static final String VERSION_NAME = &quot;X&lt;cP[?PHNB&lt;P?aj&quot;;<br>&#125;<br><br></code></pre></td></tr></table></figure>

<p>解密脚本</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">#include &lt;stdio.h&gt;<br>#include &lt;string.h&gt;<br>int main(void) &#123;<br>	char name[] = &quot;X&lt;cP[?PHNB&lt;P?aj&quot;;<br>	for(int i = 0; i &lt; strlen(name); ++i)<br>		putchar(name[i] ^15);<br><br>	return 0;<br>&#125;<br><br></code></pre></td></tr></table></figure>





<h1 id="easyjni"><a href="#easyjni" class="headerlink" title="easyjni"></a>easyjni</h1><p><a target="_blank" rel="noopener" href="https://adworld.xctf.org.cn/media/task/attachments/eb760e6a10ea4dcab700a6b7db948488.apk">下载</a></p>
<p>来源:攻防世界</p>
<p>反编译java如下:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">class MainActivity$1<br>  implements View.OnClickListener<br>&#123;<br>  MainActivity$1(MainActivity paramMainActivity, Context paramContext) &#123;&#125;<br>  <br>  public void onClick(View paramView)<br>  &#123;<br>    paramView = (EditText)((MainActivity)this.a).findViewById(2131427445);<br>    if (MainActivity.a(this.b, paramView.getText().toString())) &#123;<br>      Toast.makeText(this.a, &quot;You are right!&quot;, 1).show();<br>    &#125;<br>    for (;;)<br>    &#123;<br>      return;<br>      Toast.makeText(this.a, &quot;You are wrong! Bye~&quot;, 1).show();<br>    &#125;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure>



<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">public class MainActivity<br>  extends c<br>&#123;<br>  static<br>  &#123;<br>    System.loadLibrary(&quot;native&quot;);<br>  &#125;<br>  <br>  private boolean a(String paramString)<br>  &#123;<br>    try<br>    &#123;<br>      a locala = new com/a/easyjni/a;<br>      locala.&lt;init&gt;();<br>      bool = ncheck(locala.a(paramString.getBytes()));<br>      return bool;<br>    &#125;<br>    catch (Exception paramString)<br>    &#123;<br>      for (;;)<br>      &#123;<br>        boolean bool = false;<br>      &#125;<br>    &#125;<br>  &#125;<br>  <br>  private native boolean ncheck(String paramString);<br></code></pre></td></tr></table></figure>



<p>从以上代码可以看到, 对输入的数据先进行base64加密, 然后调用native层的ncheck函数判断是否正确.</p>
<p>ida打开libnative.so文件, 反编译ncheck函数如下:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">signed int __fastcall Java_com_a_easyjni_MainActivity_ncheck(JNIEnv *a1, int a2, int a3)<br>&#123;<br>  int v3; // r8<br>  JNIEnv *v4; // r5<br>  int v5; // r8<br>  const char *str; // r6<br>  int i; // r0<br>  char *v8; // r2<br>  char v9; // r1<br>  int v10; // r0<br>  bool v11; // nf<br>  unsigned __int8 v12; // vf<br>  int v13; // r1<br>  signed int result; // r0<br>  char en_str[32]; // [sp+3h] [bp-35h]<br>  char v16; // [sp+23h] [bp-15h]<br>  int v17; // [sp+28h] [bp-10h]<br><br>  v17 = v3;<br>  v4 = a1;<br>  v5 = a3;<br>  str = (const char *)((int (__fastcall *)(JNIEnv *, int, _DWORD))(*a1)-&gt;GetStringUTFChars)(a1, a3, 0);<br>  if ( strlen(str) == 32 )<br>  &#123;<br>    i = 0;<br>    do<br>    &#123;<br>      v8 = &amp;en_str[i];<br>      en_str[i] = str[i + 16];<br>      v9 = str[i++];<br>      v8[16] = v9;<br>    &#125;<br>    while ( i != 16 );<br>    ((void (__fastcall *)(JNIEnv *, int, const char *))(*v4)-&gt;ReleaseStringUTFChars)(v4, v5, str);<br>    v10 = 0;<br>    do<br>    &#123;<br>      v12 = __OFSUB__(v10, 30);<br>      v11 = v10 - 30 &lt; 0;<br>      v16 = en_str[v10];<br>      en_str[v10] = en_str[v10 + 1];<br>      en_str[v10 + 1] = v16;<br>      v10 += 2;<br>    &#125;<br>    while ( v11 ^ v12 );<br>    v13 = memcmp(en_str, &quot;MbT3sQgX039i3g==AQOoMQFPskB1Bsc7&quot;, 0x20u);<br>    result = 0;<br>    if ( !v13 )<br>      result = 1;<br>  &#125;<br>  else<br>  &#123;<br>    ((void (__fastcall *)(JNIEnv *, int, const char *))(*v4)-&gt;ReleaseStringUTFChars)(v4, v5, str);<br>    result = 0;<br>  &#125;<br>  return result;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>以上代码经过了两次加密, 先进行str[i]与str[i + 16]的交换, 再进行str[i]与str[i + 1]进行交换.</p>
<p>解密脚本如下:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">#include &lt;stdio.h&gt;<br>void decode() &#123;<br>        char code[] = &quot;MbT3sQgX039i3g==AQOoMQFPskB1Bsc7&quot;;<br>        for(int i = 0; i &lt; 32;  i += 2) &#123;<br>                char ch = code[i];<br>                code[i] = code[i + 1];<br>                code[i + 1] = ch;<br>        &#125;<br>        //printf(&quot;%s&quot;, code);<br>        for(int i = 0; i &lt; 16; i ++) &#123;<br>                char ch = code[i];<br>                code[i] = code[i + 16];<br>                code[i + 16] = ch;<br>        &#125;<br>        printf(&quot;%s&quot;, code);<br><br>&#125;<br>void show_arr() &#123;<br>        char arr[] = &#123; 105, 53, 106, 76, 87, 55, 83, 48, 71, 88, 54, 117, 102, 49, 99, 118, 51, 110, 121, 52, 113, 56, 101, 115, 50, 81, 43, 98, 100, 107, 89, 103, 75, 79, 73, 84, 47, 116, 65, 120, 85, 114, 70, 108, 86, 80, 122, 104, 109, 111, 119, 57, 66, 72, 67, 77, 68, 112, 69, 97, 74, 82, 90, 78, 0 &#125;;<br>        printf(&quot;%s\n&quot;, arr);<br>&#125;<br>int main(void) &#123;<br>        show_arr();<br>        decode();<br>        return 0;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>解密base64</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">import base64<br>import string<br><br>str1 = &quot;QAoOQMPFks1BsB7cbM3TQsXg30i9g3==&quot;<br><br>string1 = &quot;i5jLW7S0GX6uf1cv3ny4q8es2Q+bdkYgKOIT/tAxUrFlVPzhmow9BHCMDpEaJRZN&quot;<br>string2 = &quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&quot;<br><br><br>print (b&#x27;code: &#x27; + base64.b64decode(str1.translate(str.maketrans(string1,string2))))<br></code></pre></td></tr></table></figure>





<h1 id="easy-apk"><a href="#easy-apk" class="headerlink" title="easy apk"></a>easy apk</h1><p><a target="_blank" rel="noopener" href="https://adworld.xctf.org.cn/media/task/attachments/989ca07c3f90426fa05406e4369901ff.apk">下载</a></p>
<p>来源: 攻防世界</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">class MainActivity$1<br>  implements View.OnClickListener<br>&#123;<br>  MainActivity$1(MainActivity paramMainActivity) &#123;&#125;<br>  <br>  public void onClick(View paramView)<br>  &#123;<br>    paramView = ((EditText)this.this$0.findViewById(2131427445)).getText().toString();<br>    if (new Base64New().Base64Encode(paramView.getBytes()).equals(&quot;5rFf7E2K6rqN7Hpiyush7E6S5fJg6rsi5NBf6NGT5rs=&quot;)) &#123;<br>      Toast.makeText(this.this$0, &quot;验证通过!&quot;, 1).show();<br>    &#125;<br>    for (;;)<br>    &#123;<br>      return;<br>      Toast.makeText(this.this$0, &quot;验证失败!&quot;, 1).show();<br>    &#125;<br>  &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure>

<p>base64加密如下</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">public class Base64New<br>&#123;<br>  private static final char[] Base64ByteToStr = &#123; 118, 119, 120, 114, 115, 116, 117, 111, 112, 113, 51, 52, 53, 54, 55, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 121, 122, 48, 49, 50, 80, 81, 82, 83, 84, 75, 76, 77, 78, 79, 90, 97, 98, 99, 100, 85, 86, 87, 88, 89, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 56, 57, 43, 47 &#125;;<br>  private static final int RANGE = 255;<br>  private static byte[] StrToBase64Byte = new byte[&#x27;?&#x27;];<br>  <br>  public String Base64Encode(byte[] paramArrayOfByte)<br>  &#123;<br>    StringBuilder localStringBuilder = new StringBuilder();<br>    for (int i = 0; i &lt;= paramArrayOfByte.length - 1; i += 3)<br>    &#123;<br>      byte[] arrayOfByte = new byte[4];<br>      int j = 0;<br>      int k = 0;<br>      if (k &lt;= 2)<br>      &#123;<br>        if (i + k &lt;= paramArrayOfByte.length - 1) &#123;<br>          arrayOfByte[k] = ((byte)(byte)((paramArrayOfByte[(i + k)] &amp; 0xFF) &gt;&gt;&gt; k * 2 + 2 | j));<br>        &#125;<br>        for (j = (byte)(((paramArrayOfByte[(i + k)] &amp; 0xFF) &lt;&lt; (2 - k) * 2 + 2 &amp; 0xFF) &gt;&gt;&gt; 2);; j = 64)<br>        &#123;<br>          k++;<br>          break;<br>          arrayOfByte[k] = ((byte)j);<br>        &#125;<br>      &#125;<br>      arrayOfByte[3] = ((byte)j);<br>      j = 0;<br>      if (j &lt;= 3)<br>      &#123;<br>        if (arrayOfByte[j] &lt;= 63) &#123;<br>          localStringBuilder.append(Base64ByteToStr[arrayOfByte[j]]);<br>        &#125;<br>        for (;;)<br>        &#123;<br>          j++;<br>          break;<br>          localStringBuilder.append(&#x27;=&#x27;);<br>        &#125;<br>      &#125;<br>    &#125;<br>    return localStringBuilder.toString();<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>以上加密是对输入进行了一个base64换表的加密</p>
<p>解密脚本如下</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">import base64<br>import string<br><br><br>base_table = [ 118, 119, 120, 114, 115, 116, 117, 111, 112, 113, 51, 52, 53, 54, 55, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 121, 122, 48, 49, 50, 80, 81, 82, 83, 84, 75, 76, 77, 78, 79, 90, 97, 98, 99, 100, 85, 86, 87, 88, 89, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 56, 57, 43, 47 ];<br>string1 = &#x27;&#x27;<br>code = &#x27;5rFf7E2K6rqN7Hpiyush7E6S5fJg6rsi5NBf6NGT5rs=&#x27;<br><br>for i in range(len(base_table)):<br>    string1 += chr(base_table[i])<br><br><br>string2 = &quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&quot;<br><br>print(base64.b64decode(code.translate(str.maketrans(string1,string2))))<br></code></pre></td></tr></table></figure>

<div id="paginator"></div></div><div id="post-footer"><div id="pages"><div id="footer-link" style="right: calc(50% - 1px);order: 1;border-right: 1px solid #fe2;padding-left: unset;max-width: calc(50% - 4px);"><a href="/2020/09/09/tools/docker/debian_docker/">← Next Debian 安装 docker</a></div><div id="footer-link" style="left: 50%;order: 0;border-left: 1px solid #fe2;padding-right: unset;max-width: calc(50% - 5px);"><a href="/2020/09/06/security/reverse/android/android-debuger/">调试安卓程序 Prev →</a></div></div></div><details id="reward"><summary>打赏</summary><div id="alipay"><span>支付宝 | Alipay</span><br><img src="/img/Alipay.png"></div><div id="wechat"><span>微信 | WeChat</span><br><img src="/img/WeChat.png"></div></details><div id="Valine"></div></div><div id="bottom-btn"><a id="to-index" href="#toc-div" title="index">≡</a><a id="to-top" onClick="scrolls.scrolltop();" title="to top" style="opacity: 0; display: none;">∧</a></div></article><aside><div id="aside-top"><div id="about"><a href="/" id="logo"><img src="https://ak.hypergryph.com/assets/index/images/ak/pc/faction/1.png" alt="Logo"></a><h1 id="Dr"><a target="_blank" rel="noopener" href="https://github.com/Yue-plus">John Doe</a></h1><div id="description"></div></div><div id="aside-block"><div id="toc-div"><h1>INDEX</h1><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Android-Re-%E5%85%A5%E9%97%A8"><span class="toc-number">1.</span> <span class="toc-text">Android Re 入门</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%BF%85%E5%A4%87%E5%B7%A5%E5%85%B7"><span class="toc-number">1.1.</span> <span class="toc-text">必备工具:</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BE%8B%E9%A2%98-1-easy-so"><span class="toc-number">1.2.</span> <span class="toc-text">例题 1 [easy-so]</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BE%8B%E9%A2%98-2-app2"><span class="toc-number">2.</span> <span class="toc-text">例题 2 [app2]</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Ph0en1x-100"><span class="toc-number">3.</span> <span class="toc-text">Ph0en1x-100</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#app1"><span class="toc-number">4.</span> <span class="toc-text">app1</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#easyjni"><span class="toc-number">5.</span> <span class="toc-text">easyjni</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#easy-apk"><span class="toc-number">6.</span> <span class="toc-text">easy apk</span></a></li></ol></div></div></div><footer><nobr><span class="text-title">ICP</span><a class="text-content" target="_blank" rel="noopener" href="https://beian.miit.gov.cn/">赣ICP备19008355号</a></nobr><nobr><span class="text-title">©</span><span class="text-content">1970 to 2020</span></nobr><br><nobr>published with <a target="_blank" rel="noopener" href="http://hexo.io">Hexo</a></nobr><wbr><nobr> Theme <a target="_blank" rel="noopener" href="https://github.com/Yue-plus/hexo-theme-arknights">Arknight</a></nobr><wbr><nobr>by <a target="_blank" rel="noopener" href="https://github.com/Yue-plus">Yue_plus</a></nobr></footer></aside></main><canvas id="canvas-dust"></canvas><div id="cursor-container"><div id="cursor-outer"></div><div id="cursor-effect"></div></div><script src="/js/search.js"></script><script class="pjax-js">reset=_=>{new Valine({
 el: '#Valine'
 , appId: 'LSe7mf1XYliLqgIrc3jlqXfT-gzGzoHsz'
 , appKey: 'Fu9giJfnidkCamaW89FUpidw' , placeholder: '此条评论委托企鹅物流发送'
});code.findCode();mermaid.init(undefined, ('.mermaid'));}</script><script src="//unpkg.com/@highlightjs/cdn-assets@11.4.0/highlight.min.js"></script><script src="/js/arknights.js"></script><script>window.addEventListener("load",()=>{reset()})</script></body></html>