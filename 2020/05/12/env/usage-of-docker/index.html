<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>usage-of-docker | I0gan's blog</title><script src="//unpkg.com/valine/dist/Valine.min.js"></script><script>var config = {"root":"/","path":"search.json"}</script><script src="//unpkg.com/mermaid@8.13.5/dist/mermaid.min.js"></script><script>mermaid.initialize({
 startOnLoad: true
 , theme: 'dark'
});</script><link rel="stylesheet" href="/css/arknights.css"><link rel="stylesheet" href="//unpkg.com/@highlightjs/cdn-assets@11.4.0/styles/atom-one-dark-reasonable.min.css"><style>@font-face {
 font-family: BenderLight;
 src: local('Bender'), url("/font/BenderLight.ttf");
}
@font-face {
 font-family: 'JetBrains Mono';
 src: local('JetBrains Mono'), url('/font/JetBrainsMono-Regular.woff2') format('woff2');
}</style><meta name="generator" content="Hexo 6.3.0"></head><body style="background-image:url(/img/bg.jpg);"><main><header class="closed"><nav><div class="navBtn"><i class="navBtnIcon"><span class="navBtnIconBar"></span><span class="navBtnIconBar"></span><span class="navBtnIconBar"></span></i></div><ol class="navContent"><li class="navItem" id="search-header"><span class="navItemTitle"><input autocomplete="off" autocorrect="off" autocapitalize="none" placeholder="Search" spellcheck="false" maxlength="50" type="text" id="search-input"></span></li><li class="navItem"><a class="navBlock" href="/"><span class="navItemTitle">Home</span></a></li><li class="navItem"><a class="navBlock" href="/about/"><span class="navItemTitle">About</span></a></li><li class="navItem" matchdata="categories,tags"><a class="navBlock" href="/archives/"><span class="navItemTitle">Archives</span></a></li><li class="navItem"><a class="navBlock" href="/shell/"><span class="navItemTitle">Shell</span></a></li></ol></nav><div class="search-popup"><div id="search-result"></div></div></header><article><div id="post-bg"><div id="post-title"><h1>usage-of-docker</h1><div id="post-info"><span>First Post: <div class="control"><time datetime="2020-05-12T03:07:08.000Z" id="date"> 2020-05-12</time></div></span><br><span>Last Update: <div class="control"><time datetime="2024-10-07T08:17:07.907Z" id="updated"> 2024-10-07</time></div></span><br><span>Word Count: <div class="control">1.1k</div></span><br><span>Read Time: <div class="control">4 min</div></span></div></div><hr><div id="post-content"><h2 id="Docker-Hub-需要配置加速器"><a href="#Docker-Hub-需要配置加速器" class="headerlink" title="Docker Hub (需要配置加速器)"></a>Docker Hub (需要配置加速器)</h2><p>关闭 SELINUX 服务<br>SELINUX是CentOS系统捆绑的安全服务程序, 因为安全策略过于严格, 所以建议关闭这个服务<br>修改 &#x2F;etc&#x2F;selinux&#x2F;config文件, 设置SELINUX&#x3D;disabled<br>安装:<br>Centos: </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">yum install docker -y //-y代表默认安装<br>service docker start<br>service docker stop<br>service docker restart<br></code></pre></td></tr></table></figure>



<p>Debain:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">sudo apt install docker<br>sudo apt install docker-compose<br></code></pre></td></tr></table></figure>



<p>CockerHub: 是Docker公共镜像库, 为用户提供了大量的镜像文件<br><a target="_blank" rel="noopener" href="https://hub.docker.com/">https://hub.docker.com/</a><br>由于国内网络访问DockerHub很慢, 无法下载镜像文件,我们可以使用Docker加速器</p>
<p>网易镜像中心：<a target="_blank" rel="noopener" href="https://c.163.com/hub#/m/home/">https://c.163.com/hub#/m/home/</a><br>docker pull hub.c.163.com&#x2F;library&#x2F;tomcat:latest</p>
<p>docker 中科大源: <a target="_blank" rel="noopener" href="https://lug.ustc.edu.cn/wiki/mirrors/help/docker">https://lug.ustc.edu.cn/wiki/mirrors/help/docker</a></p>
<p>安装加速器:<br>curl -sSl <a target="_blank" rel="noopener" href="https://get.daocloud.io/daotools/set_mirror.sh">https://get.daocloud.io/daotools/set_mirror.sh</a> | sh -s <a target="_blank" rel="noopener" href="http://f1361db2.m.daocloud.io/">http://f1361db2.m.daocloud.io</a><br>&#x2F;&#x2F;启动加速器<br>.&#x2F;acc.sh {“registry-mirrors”: [“<a href="http://f1361db2.m.daocloud.io&quot;]}">http://f1361db2.m.daocloud.io&quot;]}</a></p>
<p>修改Docker配置文件,去掉逗号<br>vim &#x2F;etc&#x2F;docker&#x2F;daemon.json<br>{“registry-mirrors”: [“<a href="http://f1361db2.m.daocloud.io&quot;]}">http://f1361db2.m.daocloud.io&quot;]}</a></p>
<h3 id="安装python镜像"><a href="#安装python镜像" class="headerlink" title="安装python镜像:"></a>安装python镜像:</h3><p>docker pull python:3.8</p>
<h3 id="查看镜像"><a href="#查看镜像" class="headerlink" title="查看镜像:"></a>查看镜像:</h3><p>docker images</p>
<h3 id="查看镜像的详细信息"><a href="#查看镜像的详细信息" class="headerlink" title="查看镜像的详细信息:"></a>查看镜像的详细信息:</h3><p>docker inspect python:3.8</p>
<h3 id="将镜像导出"><a href="#将镜像导出" class="headerlink" title="将镜像导出"></a>将镜像导出</h3><p>docker save python:3.8 &gt; &#x2F;root&#x2F;python.tar</p>
<h3 id="删除镜像"><a href="#删除镜像" class="headerlink" title="删除镜像"></a>删除镜像</h3><p>docker rmi python:3.8</p>
<h3 id="导入镜像"><a href="#导入镜像" class="headerlink" title="导入镜像"></a>导入镜像</h3><p>docker load &lt; &#x2F;root&#x2F;python.tar</p>
<h3 id="创建docker容器"><a href="#创建docker容器" class="headerlink" title="创建docker容器:"></a>创建docker容器:</h3><p>it代表创建一个容器, 后面需要交互, bash交互<br>docker run -it –name&#x3D;p1 python:3.8 bash</p>
<h3 id="查看容器"><a href="#查看容器" class="headerlink" title="查看容器"></a>查看容器</h3><p>docker ps -a</p>
<h3 id="启动容器"><a href="#启动容器" class="headerlink" title="启动容器"></a>启动容器</h3><p>容器名为p1<br>docker start p1</p>
<h3 id="暂停容器"><a href="#暂停容器" class="headerlink" title="暂停容器:"></a>暂停容器:</h3><p>docker pause p1</p>
<h3 id="取消暂停容器"><a href="#取消暂停容器" class="headerlink" title="取消暂停容器:"></a>取消暂停容器:</h3><p>docker unpause p1</p>
<h3 id="使用bash进入p1容器"><a href="#使用bash进入p1容器" class="headerlink" title="使用bash进入p1容器"></a>使用bash进入p1容器</h3><p>docker exec -it p1 bash</p>
<h3 id="查看容器详细信息"><a href="#查看容器详细信息" class="headerlink" title="查看容器详细信息"></a>查看容器详细信息</h3><p>docker inspect p1</p>
<h3 id="停止容器"><a href="#停止容器" class="headerlink" title="停止容器"></a>停止容器</h3><p>docker stop p1</p>
<h3 id="删除容器"><a href="#删除容器" class="headerlink" title="删除容器"></a>删除容器</h3><p>必须先停止容器<br>docker rm p1</p>
<h3 id="Docker-网络"><a href="#Docker-网络" class="headerlink" title="Docker 网络"></a>Docker 网络</h3><p>是Docket内的内部网络</p>
<p>默认情况下, Docker环境会给容器分配动态的IP地址,这就导致下次启动容器的时候,IP地址就变了<br>可以单独创建Docker内部的网段(172.18.0.x)<br>172.18.0.0&#x2F;16 表示网络码占16位，也就是说该网络上可以有65534个主机(2^16-2)IP范 围：172.18.0.1~172.18.255.254 172.18.255.255是广播地址，不能被主机使用.设置IP地址的时候：172.18.x.y 子网掩码：255.255.0.0<br>mynet 是自定义名字</p>
<p>docker network create –subnet&#x3D;172.18.0.0&#x2F;16 docker_net</p>
<h3 id="解除容器绑定的网络-网络名词docker-net-容器名称-test"><a href="#解除容器绑定的网络-网络名词docker-net-容器名称-test" class="headerlink" title="解除容器绑定的网络 网络名词docker_net 容器名称 test"></a>解除容器绑定的网络 网络名词docker_net 容器名称 test</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">sudo docker network disconnect docker_net test<br></code></pre></td></tr></table></figure>

<h3 id="删除原先的网络"><a href="#删除原先的网络" class="headerlink" title="删除原先的网络"></a>删除原先的网络</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">sudo docker network rm docker_net<br></code></pre></td></tr></table></figure>

<h3 id="创建新的网络"><a href="#创建新的网络" class="headerlink" title="创建新的网络"></a>创建新的网络</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">sudo docker network create --subnet=192.168.222.0/24 mynetwork<br></code></pre></td></tr></table></figure>

<h2 id="连接新的网络"><a href="#连接新的网络" class="headerlink" title="连接新的网络"></a>连接新的网络</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">sudo docker network connect mynetwork test <br></code></pre></td></tr></table></figure>

<h3 id="重新启动容器"><a href="#重新启动容器" class="headerlink" title="重新启动容器"></a>重新启动容器</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">sudo docker container restart test<br></code></pre></td></tr></table></figure>

<h4 id="注意"><a href="#注意" class="headerlink" title="注意:"></a>注意:</h4><p>删除某个网段, 删除网段之前, 必须先删除容器</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">docker network rm mynet<br></code></pre></td></tr></table></figure>

<p>创建容器并指定ip, 而 172.18.0.1是网关地址, 是不能使用的<br>docker run -it –net mynet –ip 172.18.0.2 python:3.8 bash</p>
<h4 id="查看网段"><a href="#查看网段" class="headerlink" title="查看网段"></a>查看网段</h4><p>docker network ls</p>
<h4 id="删除mynet网段"><a href="#删除mynet网段" class="headerlink" title="删除mynet网段"></a>删除mynet网段</h4><p>docker network rm mynet</p>
<h4 id="指定某个ip创建容器"><a href="#指定某个ip创建容器" class="headerlink" title="指定某个ip创建容器"></a>指定某个ip创建容器</h4><p>docker run -it –name&#x3D;p1 –net mynet –ip 172.18.0.2 python:3.8 bash</p>
<h4 id="容器端口映射"><a href="#容器端口映射" class="headerlink" title="容器端口映射"></a>容器端口映射</h4><p>默认情况下, 除了宿主机之外,任何主机无法访问远程Docker容器<br>通过端口映射,可以吧容器端口映射到宿主机的端口,这样其他主机就能访问了<br>映射到宿主机的端口,不需要设置防火墙规则,便可以使用<br>将容器的5000端口映射到宿主机的9500端口<br>docker run -it -p 9500:5000 python:3.8 bash</p>
<h4 id="映射多个端口"><a href="#映射多个端口" class="headerlink" title="映射多个端口"></a>映射多个端口</h4><p>docker run -it -p 9500:5000 -p 9600:3306 python:3.8 bash</p>
<h3 id="目录挂载在技术"><a href="#目录挂载在技术" class="headerlink" title="目录挂载在技术"></a>目录挂载在技术</h3><p>为了能把一部分业务数据保存在Docker环境之外,或者把宿主机的文件传入容器,所以<br>需要给容器挂载宿主机的目录<br>Docker环境只支持目录挂载,不支持文件挂载, 且一个容器可以挂载多个目录</p>
<p>将宿主机的&#x2F;root&#x2F;test目录挂载到容器的&#x2F;root&#x2F;project 目录中<br>docker run -it -v &#x2F;root&#x2F;test:&#x2F;root&#x2F;project –name&#x3D;p1 python:3.8 bash</p>
<h2 id="给docker添加用户组"><a href="#给docker添加用户组" class="headerlink" title="给docker添加用户组"></a>给docker添加用户组</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs sh">sudo groupadd docker    <span class="hljs-comment">#添加docker用户组</span><br>sudo gpasswd -a <span class="hljs-variable">$USER</span> docker <span class="hljs-comment">#将登陆用户加入到docker用户组中</span><br>newgrp docker <span class="hljs-comment">#更新用户组</span><br>docker ps     <span class="hljs-comment">#测试docker命令是否可以使用sudo正常使用</span><br></code></pre></td></tr></table></figure>
<div id="paginator"></div></div><div id="post-footer"><div id="pages"><div id="footer-link" style="right: calc(50% - 1px);order: 1;border-right: 1px solid #fe2;padding-left: unset;max-width: calc(50% - 4px);"><a href="/2020/05/26/dev/language/c/thread/">← Next c线程操作</a></div><div id="footer-link" style="left: 50%;order: 0;border-left: 1px solid #fe2;padding-right: unset;max-width: calc(50% - 5px);"><a href="/2020/05/12/env/linux/install_docker_on_debian/">install-docker-on-debian Prev →</a></div></div></div><details id="reward"><summary>打赏点小钱</summary><div id="alipay"><span>支付宝 | Alipay</span><br><img src="/img/Alipay.png"></div><div id="wechat"><span>微信 | WeChat</span><br><img src="/img/WeChat.png"></div></details><div id="Valine"></div></div><div id="bottom-btn"><a id="to-index" href="#toc-div" title="index">≡</a><a id="to-top" onClick="scrolls.scrolltop();" title="to top" style="opacity: 0; display: none;">∧</a></div></article><aside><div id="aside-top"><div id="about"><a href="/" id="logo"><img src="/images/header.jpg" alt="Logo"></a><h1 id="Dr"><a target="_blank" rel="noopener" href="https://github.com/i0gan">I0gan</a></h1><div id="description"></div></div><div id="aside-block"><div id="toc-div"><h1>INDEX</h1><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Docker-Hub-%E9%9C%80%E8%A6%81%E9%85%8D%E7%BD%AE%E5%8A%A0%E9%80%9F%E5%99%A8"><span class="toc-text">Docker Hub (需要配置加速器)</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%89%E8%A3%85python%E9%95%9C%E5%83%8F"><span class="toc-text">安装python镜像:</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9F%A5%E7%9C%8B%E9%95%9C%E5%83%8F"><span class="toc-text">查看镜像:</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9F%A5%E7%9C%8B%E9%95%9C%E5%83%8F%E7%9A%84%E8%AF%A6%E7%BB%86%E4%BF%A1%E6%81%AF"><span class="toc-text">查看镜像的详细信息:</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B0%86%E9%95%9C%E5%83%8F%E5%AF%BC%E5%87%BA"><span class="toc-text">将镜像导出</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%A0%E9%99%A4%E9%95%9C%E5%83%8F"><span class="toc-text">删除镜像</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AF%BC%E5%85%A5%E9%95%9C%E5%83%8F"><span class="toc-text">导入镜像</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%9B%E5%BB%BAdocker%E5%AE%B9%E5%99%A8"><span class="toc-text">创建docker容器:</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9F%A5%E7%9C%8B%E5%AE%B9%E5%99%A8"><span class="toc-text">查看容器</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%90%AF%E5%8A%A8%E5%AE%B9%E5%99%A8"><span class="toc-text">启动容器</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9A%82%E5%81%9C%E5%AE%B9%E5%99%A8"><span class="toc-text">暂停容器:</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%96%E6%B6%88%E6%9A%82%E5%81%9C%E5%AE%B9%E5%99%A8"><span class="toc-text">取消暂停容器:</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8bash%E8%BF%9B%E5%85%A5p1%E5%AE%B9%E5%99%A8"><span class="toc-text">使用bash进入p1容器</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9F%A5%E7%9C%8B%E5%AE%B9%E5%99%A8%E8%AF%A6%E7%BB%86%E4%BF%A1%E6%81%AF"><span class="toc-text">查看容器详细信息</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%81%9C%E6%AD%A2%E5%AE%B9%E5%99%A8"><span class="toc-text">停止容器</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%A0%E9%99%A4%E5%AE%B9%E5%99%A8"><span class="toc-text">删除容器</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Docker-%E7%BD%91%E7%BB%9C"><span class="toc-text">Docker 网络</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A7%A3%E9%99%A4%E5%AE%B9%E5%99%A8%E7%BB%91%E5%AE%9A%E7%9A%84%E7%BD%91%E7%BB%9C-%E7%BD%91%E7%BB%9C%E5%90%8D%E8%AF%8Ddocker-net-%E5%AE%B9%E5%99%A8%E5%90%8D%E7%A7%B0-test"><span class="toc-text">解除容器绑定的网络 网络名词docker_net 容器名称 test</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%A0%E9%99%A4%E5%8E%9F%E5%85%88%E7%9A%84%E7%BD%91%E7%BB%9C"><span class="toc-text">删除原先的网络</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E6%96%B0%E7%9A%84%E7%BD%91%E7%BB%9C"><span class="toc-text">创建新的网络</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%BF%9E%E6%8E%A5%E6%96%B0%E7%9A%84%E7%BD%91%E7%BB%9C"><span class="toc-text">连接新的网络</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%87%8D%E6%96%B0%E5%90%AF%E5%8A%A8%E5%AE%B9%E5%99%A8"><span class="toc-text">重新启动容器</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%B3%A8%E6%84%8F"><span class="toc-text">注意:</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9F%A5%E7%9C%8B%E7%BD%91%E6%AE%B5"><span class="toc-text">查看网段</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%A0%E9%99%A4mynet%E7%BD%91%E6%AE%B5"><span class="toc-text">删除mynet网段</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%8C%87%E5%AE%9A%E6%9F%90%E4%B8%AAip%E5%88%9B%E5%BB%BA%E5%AE%B9%E5%99%A8"><span class="toc-text">指定某个ip创建容器</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%B9%E5%99%A8%E7%AB%AF%E5%8F%A3%E6%98%A0%E5%B0%84"><span class="toc-text">容器端口映射</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%98%A0%E5%B0%84%E5%A4%9A%E4%B8%AA%E7%AB%AF%E5%8F%A3"><span class="toc-text">映射多个端口</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%9B%AE%E5%BD%95%E6%8C%82%E8%BD%BD%E5%9C%A8%E6%8A%80%E6%9C%AF"><span class="toc-text">目录挂载在技术</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BB%99docker%E6%B7%BB%E5%8A%A0%E7%94%A8%E6%88%B7%E7%BB%84"><span class="toc-text">给docker添加用户组</span></a></li></ol></div></div></div><footer><nobr><span class="text-title">ICP</span><a class="text-content" target="_blank" rel="noopener" href="https://beian.miit.gov.cn/">沪ICP备2021037250号-1  </a></nobr><nobr><span class="text-title">©</span><span class="text-content">2022 by i0gan</span></nobr><br></footer></aside></main><canvas id="canvas-dust"></canvas><div id="cursor-container"><div id="cursor-outer"></div><div id="cursor-effect"></div></div><script src="/js/search.js"></script><script class="pjax-js">reset=_=>{new Valine({
 el: '#Valine'
 , appId: 'TzNey4n3v0Sx6vdBbytYLoH9-gzGzoHsz'
 , appKey: 'GIXXrK9zLxt0bZLww1hte0Oq' , placeholder: '此条评论委托企鹅物流发送'
});code.findCode();mermaid.init(undefined, ('.mermaid'));}</script><script src="//unpkg.com/@highlightjs/cdn-assets@11.4.0/highlight.min.js"></script><script src="/js/arknights.js"></script><script>window.addEventListener("load",()=>{reset()})</script></body></html>